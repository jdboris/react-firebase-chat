[debug] [2021-04-20T18:11:57.058Z] ----------------------------------------------------------------------
[debug] [2021-04-20T18:11:57.060Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js emulators:start
[debug] [2021-04-20T18:11:57.061Z] CLI Version:   9.10.0
[debug] [2021-04-20T18:11:57.061Z] Platform:      win32
[debug] [2021-04-20T18:11:57.061Z] Node Version:  v12.18.4
[debug] [2021-04-20T18:11:57.066Z] Time:          Tue Apr 20 2021 14:11:57 GMT-0400 (Eastern Daylight Time)
[debug] [2021-04-20T18:11:57.066Z] ----------------------------------------------------------------------
[debug] 
[debug] [2021-04-20T18:11:57.069Z] >>> [apiv2][query] GET https://firebase-public.firebaseio.com/cli.json [none]
[debug] [2021-04-20T18:11:57.098Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2021-04-20T18:11:57.098Z] > authorizing via signed-in user (josephdboris@gmail.com)
[info] i  emulators: Starting emulators: auth, functions, firestore {"metadata":{"emulator":{"name":"hub"},"message":"Starting emulators: auth, functions, firestore"}}
[debug] [2021-04-20T18:11:57.577Z] <<< [apiv2][status] GET https://firebase-public.firebaseio.com/cli.json 200
[debug] [2021-04-20T18:11:57.577Z] <<< [apiv2][body] GET https://firebase-public.firebaseio.com/cli.json {"cloudBuildErrorAfter":1594252800000,"cloudBuildWarnAfter":1590019200000,"defaultNode10After":1594252800000,"minVersion":"3.0.5","node8DeploysDisabledAfter":1613390400000,"node8RuntimeDisabledAfter":1615809600000,"node8WarnAfter":1600128000000}
[debug] [2021-04-20T18:11:59.136Z] [hub] writing locator at C:\Users\Joe\AppData\Local\Temp\hub-stream-site-9ebd9.json
[warn] !  functions: The following emulators are not running, calls to these services from the Functions emulator will affect production: database, hosting, pubsub {"metadata":{"emulator":{"name":"functions"},"message":"The following emulators are not running, calls to these services from the Functions emulator will affect production: \u001b[1mdatabase, hosting, pubsub\u001b[22m"}}
[info] +  functions: Using node@12 from host. {"metadata":{"emulator":{"name":"functions"},"message":"Using node@12 from host."}}
[debug] [2021-04-20T18:12:01.195Z] defaultcredentials: writing to file C:\Users\Joe\AppData\Roaming\firebase\josephdboris_gmail_com_application_default_credentials.json
[debug] [2021-04-20T18:12:01.196Z] Setting GAC to C:\Users\Joe\AppData\Roaming\firebase\josephdboris_gmail_com_application_default_credentials.json {"metadata":{"emulator":{"name":"functions"},"message":"Setting GAC to C:\\Users\\Joe\\AppData\\Roaming\\firebase\\josephdboris_gmail_com_application_default_credentials.json"}}
[debug] [2021-04-20T18:12:01.197Z] > refreshing access token with scopes: []
[debug] [2021-04-20T18:12:01.198Z] >>> HTTP REQUEST POST https://www.googleapis.com/oauth2/v3/token  
 <request body omitted>
[debug] [2021-04-20T18:12:01.328Z] <<< HTTP RESPONSE 200 {"pragma":"no-cache","cache-control":"no-cache, no-store, max-age=0, must-revalidate","expires":"Mon, 01 Jan 1990 00:00:00 GMT","date":"Tue, 20 Apr 2021 18:12:01 GMT","content-type":"application/json; charset=utf-8","vary":"X-Origin, Referer, Origin,Accept-Encoding","server":"scaffolding on HTTPServer2","x-xss-protection":"0","x-frame-options":"SAMEORIGIN","x-content-type-options":"nosniff","alt-svc":"h3-29=\":443\"; ma=2592000,h3-T051=\":443\"; ma=2592000,h3-Q050=\":443\"; ma=2592000,h3-Q046=\":443\"; ma=2592000,h3-Q043=\":443\"; ma=2592000,quic=\":443\"; ma=2592000; v=\"46,43\"","accept-ranges":"none","transfer-encoding":"chunked"}
[debug] [2021-04-20T18:12:01.338Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/stream-site-9ebd9/adminSdkConfig [none]
[debug] [2021-04-20T18:12:02.046Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/stream-site-9ebd9/adminSdkConfig 200
[debug] [2021-04-20T18:12:02.046Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/stream-site-9ebd9/adminSdkConfig {"projectId":"stream-site-9ebd9","storageBucket":"stream-site-9ebd9.appspot.com","locationId":"us-central"}
[debug] [2021-04-20T18:12:04.077Z] Ignoring unsupported arg: projectId {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: projectId"}}
[debug] [2021-04-20T18:12:04.077Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"firestore"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2021-04-20T18:12:04.077Z] Starting Firestore Emulator with command {"binary":"java","args":["-Dgoogle.cloud_firestore.debug_log_level=FINE","-Duser.language=en","-jar","C:\\Users\\Joe\\.cache\\firebase\\emulators\\cloud-firestore-emulator-v1.11.14.jar","--host","localhost","--port",8080,"--rules","C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\firestore.rules","--functions_emulator","localhost:5001"],"optionalArgs":["port","webchannel_port","host","rules","functions_emulator","seed_from_export"],"joinArgs":false} {"metadata":{"emulator":{"name":"firestore"},"message":"Starting Firestore Emulator with command {\"binary\":\"java\",\"args\":[\"-Dgoogle.cloud_firestore.debug_log_level=FINE\",\"-Duser.language=en\",\"-jar\",\"C:\\\\Users\\\\Joe\\\\.cache\\\\firebase\\\\emulators\\\\cloud-firestore-emulator-v1.11.14.jar\",\"--host\",\"localhost\",\"--port\",8080,\"--rules\",\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\firestore.rules\",\"--functions_emulator\",\"localhost:5001\"],\"optionalArgs\":[\"port\",\"webchannel_port\",\"host\",\"rules\",\"functions_emulator\",\"seed_from_export\"],\"joinArgs\":false}"}}
[info] i  firestore: Firestore Emulator logging to firestore-debug.log {"metadata":{"emulator":{"name":"firestore"},"message":"Firestore Emulator logging to \u001b[1mfirestore-debug.log\u001b[22m"}}
[debug] [2021-04-20T18:12:15.159Z] Ignoring unsupported arg: auto_download {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: auto_download"}}
[debug] [2021-04-20T18:12:15.160Z] Ignoring unsupported arg: port {"metadata":{"emulator":{"name":"ui"},"message":"Ignoring unsupported arg: port"}}
[debug] [2021-04-20T18:12:15.160Z] Starting Emulator UI with command {"binary":"node","args":["C:\\Users\\Joe\\.cache\\firebase\\emulators\\ui-v1.4.2\\server.bundle.js"],"optionalArgs":[],"joinArgs":false} {"metadata":{"emulator":{"name":"ui"},"message":"Starting Emulator UI with command {\"binary\":\"node\",\"args\":[\"C:\\\\Users\\\\Joe\\\\.cache\\\\firebase\\\\emulators\\\\ui-v1.4.2\\\\server.bundle.js\"],\"optionalArgs\":[],\"joinArgs\":false}"}}
[info] i  ui: Emulator UI logging to ui-debug.log {"metadata":{"emulator":{"name":"ui"},"message":"Emulator UI logging to \u001b[1mui-debug.log\u001b[22m"}}
[debug] [2021-04-20T18:12:15.295Z] Web / API server started at http://localhost:4000
 {"metadata":{"emulator":{"name":"ui"},"message":"Web / API server started at http://localhost:4000\n"}}
[info] i  functions: Watching "C:\Users\Joe\Source\Repos\react-firebase-chat\functions" for Cloud Functions... {"metadata":{"emulator":{"name":"functions"},"message":"Watching \"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\" for Cloud Functions..."}}
[debug] [2021-04-20T18:12:15.681Z] [worker-pool] addWorker(~diagnostic~) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(~diagnostic~)"}}
[debug] [2021-04-20T18:12:15.681Z] [worker-pool] Adding worker with key ~diagnostic~, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key ~diagnostic~, total=1"}}
[debug] [2021-04-20T18:12:15.681Z] [worker-pool] submitWork(triggerId=) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=)"}}
[debug] [2021-04-20T18:12:15.681Z] [worker-~diagnostic~-8f6d0359-3ce6-4c66-9c27-c7a288c87905]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\1700 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-~diagnostic~-8f6d0359-3ce6-4c66-9c27-c7a288c87905]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\1700"}}
[debug] [2021-04-20T18:12:15.682Z] [worker-~diagnostic~-8f6d0359-3ce6-4c66-9c27-c7a288c87905]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-~diagnostic~-8f6d0359-3ce6-4c66-9c27-c7a288c87905]: BUSY"}}
[debug] [2021-04-20T18:12:16.033Z] [runtime-status] [1700] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:12:16.033Z] [runtime-status] [1700] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:12:16.039Z] [runtime-status] [1700] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.043Z] [runtime-status] [1700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.044Z] [runtime-status] [1700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.046Z] [runtime-status] [1700] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:12:16.047Z] [runtime-status] [1700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.133Z] [runtime-status] [1700] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:12:16.133Z] [runtime-status] [1700] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:12:16.134Z] [runtime-status] [1700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.137Z] [runtime-status] [1700] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.138Z] [runtime-status] [1700] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:12:16.138Z] [runtime-status] [1700] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:12:16.154Z] [runtime-status] [1700] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"message":"[runtime-status] [1700] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:12:16.748Z] addFirestoreTrigger "{\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"}}"
[debug] [2021-04-20T18:12:16.749Z] >>> HTTP REQUEST PUT http://localhost:8080/emulator/v1/projects/stream-site-9ebd9/triggers/detectEvilUsers-0  
 {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"}}
[debug] [2021-04-20T18:12:16.750Z] [worker-~diagnostic~-8f6d0359-3ce6-4c66-9c27-c7a288c87905]: IDLE {"metadata":{"emulator":{"name":"functions"},"message":"[worker-~diagnostic~-8f6d0359-3ce6-4c66-9c27-c7a288c87905]: IDLE"}}
[debug] [2021-04-20T18:12:17.879Z] <<< HTTP RESPONSE 200 {"content-type":"application/json","content-length":"4"}
[info] +  functions[detectEvilUsers]: firestore function initialized. {"metadata":{"emulator":{"name":"functions"},"message":"\u001b[1mfirestore\u001b[22m function initialized."}}
[info] 
┌─────────────────────────────────────────────────────────────┐
│ ✔  All emulators ready! It is now safe to connect your app. │
│ i  View Emulator UI at http://localhost:4000                │
└─────────────────────────────────────────────────────────────┘

┌────────────────┬────────────────┬─────────────────────────────────┐
│ Emulator       │ Host:Port      │ View in Emulator UI             │
├────────────────┼────────────────┼─────────────────────────────────┤
│ Authentication │ localhost:9099 │ http://localhost:4000/auth      │
├────────────────┼────────────────┼─────────────────────────────────┤
│ Functions      │ localhost:5001 │ http://localhost:4000/functions │
├────────────────┼────────────────┼─────────────────────────────────┤
│ Firestore      │ localhost:8080 │ http://localhost:4000/firestore │
└────────────────┴────────────────┴─────────────────────────────────┘
  Emulator Hub running at localhost:4400
  Other reserved ports: 4500

Issues? Report them at https://github.com/firebase/firebase-tools/issues and attach the *-debug.log files.
 
[debug] [2021-04-20T18:13:10.364Z] >>> [apiv2][query] POST http://localhost:5001/functions/projects/stream-site-9ebd9/trigger_multicast [none]
[debug] [2021-04-20T18:13:10.365Z] >>> [apiv2][body] POST http://localhost:5001/functions/projects/stream-site-9ebd9/trigger_multicast {"eventType":"providers/firebase.auth/eventTypes/user.create","data":{"uid":"91uPOOT77PKb3e4lV9WBO1l2IBsu","metadata":{"creationTime":"1618942390364","lastSignInTime":"1618942390364"},"customClaims":{}}}
[debug] [2021-04-20T18:13:10.373Z] <<< [apiv2][status] POST http://localhost:5001/functions/projects/stream-site-9ebd9/trigger_multicast 200
[debug] [2021-04-20T18:13:10.373Z] <<< [apiv2][body] POST http://localhost:5001/functions/projects/stream-site-9ebd9/trigger_multicast {"status":"multicast_acknowledged"}
[debug] [2021-04-20T18:30:24.027Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:30:24.027Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:30:24.027Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:30:24.033Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:30:24.033Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:30:24.034Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:30:24.034Z] [worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\10420 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\10420"}}
[debug] [2021-04-20T18:30:24.034Z] [worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: BUSY"}}
[debug] [2021-04-20T18:30:24.304Z] [runtime-status] [10420] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:30:24.305Z] [runtime-status] [10420] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:30:24.309Z] [runtime-status] [10420] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.311Z] [runtime-status] [10420] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.312Z] [runtime-status] [10420] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.313Z] [runtime-status] [10420] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:30:24.314Z] [runtime-status] [10420] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.373Z] [runtime-status] [10420] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:30:24.373Z] [runtime-status] [10420] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:30:24.374Z] [runtime-status] [10420] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.375Z] [runtime-status] [10420] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.378Z] [runtime-status] [10420] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:30:24.378Z] [runtime-status] [10420] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:30:24.387Z] [runtime-status] [10420] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:30:24.751Z] [runtime-status] [10420] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:30:24.752Z] [runtime-status] [10420] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:30:24.753Z] [runtime-status] [10420] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:30:24.753Z] [runtime-status] [10420] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:30:23.826Z"}},"createTime":"2021-04-20T18:30:23.896019Z","updateTime":"2021-04-20T18:30:23.896019Z"},"updateMask":{}},"context":{"eventId":"cf3daec4-750b-4244-be47-d750a93f578c","timestamp":"2021-04-20T18:30:23.896Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:30:23.826Z\"}},\"createTime\":\"2021-04-20T18:30:23.896019Z\",\"updateTime\":\"2021-04-20T18:30:23.896019Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"cf3daec4-750b-4244-be47-d750a93f578c\",\"timestamp\":\"2021-04-20T18:30:23.896Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:30:24.753Z] [runtime-status] [10420] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:30:24.753Z] [runtime-status] [10420] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:30:23.826Z"}},"createTime":"2021-04-20T18:30:23.896019Z","updateTime":"2021-04-20T18:30:23.896019Z"},"updateMask":{}},"context":{"eventId":"cf3daec4-750b-4244-be47-d750a93f578c","timestamp":"2021-04-20T18:30:23.896Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:30:23.826Z\"}},\"createTime\":\"2021-04-20T18:30:23.896019Z\",\"updateTime\":\"2021-04-20T18:30:23.896019Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"cf3daec4-750b-4244-be47-d750a93f578c\",\"timestamp\":\"2021-04-20T18:30:23.896Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/XYNrLzDEioref7Mx6Cep\"}}"}}
[debug] [2021-04-20T18:30:24.972Z] [runtime-status] [10420] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [10420] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:30:24.977Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:30:24.989Z] [worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: exited"}}
[debug] [2021-04-20T18:30:24.990Z] [worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-d1574fd9-500c-4177-ab80-ca87624e5a35]: FINISHED"}}
[debug] [2021-04-20T18:31:08.216Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:08.216Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:08.216Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:08.216Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:08.223Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:08.223Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:08.223Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:08.223Z] [worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\6716 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\6716"}}
[debug] [2021-04-20T18:31:08.223Z] [worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: BUSY"}}
[debug] [2021-04-20T18:31:08.490Z] [runtime-status] [6716] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:08.491Z] [runtime-status] [6716] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:08.495Z] [runtime-status] [6716] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.497Z] [runtime-status] [6716] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.498Z] [runtime-status] [6716] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.499Z] [runtime-status] [6716] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:08.500Z] [runtime-status] [6716] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.557Z] [runtime-status] [6716] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:08.557Z] [runtime-status] [6716] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:08.557Z] [runtime-status] [6716] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.559Z] [runtime-status] [6716] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.561Z] [runtime-status] [6716] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:08.561Z] [runtime-status] [6716] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:08.569Z] [runtime-status] [6716] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:08.940Z] [runtime-status] [6716] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:08.941Z] [runtime-status] [6716] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:08.941Z] [runtime-status] [6716] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:08.941Z] [runtime-status] [6716] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:08.153Z"}},"createTime":"2021-04-20T18:31:08.157983Z","updateTime":"2021-04-20T18:31:08.157983Z"},"updateMask":{}},"context":{"eventId":"09b5bf28-7811-48c2-b240-ba055962321d","timestamp":"2021-04-20T18:31:08.157Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:08.153Z\"}},\"createTime\":\"2021-04-20T18:31:08.157983Z\",\"updateTime\":\"2021-04-20T18:31:08.157983Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"09b5bf28-7811-48c2-b240-ba055962321d\",\"timestamp\":\"2021-04-20T18:31:08.157Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:08.941Z] [runtime-status] [6716] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:08.941Z] [runtime-status] [6716] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:08.153Z"}},"createTime":"2021-04-20T18:31:08.157983Z","updateTime":"2021-04-20T18:31:08.157983Z"},"updateMask":{}},"context":{"eventId":"09b5bf28-7811-48c2-b240-ba055962321d","timestamp":"2021-04-20T18:31:08.157Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:08.153Z\"}},\"createTime\":\"2021-04-20T18:31:08.157983Z\",\"updateTime\":\"2021-04-20T18:31:08.157983Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"09b5bf28-7811-48c2-b240-ba055962321d\",\"timestamp\":\"2021-04-20T18:31:08.157Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/HTzk2nzTwpWEfjnEZM1H\"}}"}}
[debug] [2021-04-20T18:31:09.148Z] [runtime-status] [6716] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [6716] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:09.151Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:09.156Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:09.156Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:09.156Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:09.161Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:09.161Z] [worker-pool] Adding worker with key detectEvilUsers, total=2 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=2"}}
[debug] [2021-04-20T18:31:09.161Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:09.162Z] [worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\11320 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\11320"}}
[debug] [2021-04-20T18:31:09.162Z] [worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: BUSY"}}
[debug] [2021-04-20T18:31:09.163Z] [worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: exited"}}
[debug] [2021-04-20T18:31:09.163Z] [worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-7f001a5b-0792-4b1d-8784-6a65c7761f8a]: FINISHED"}}
[debug] [2021-04-20T18:31:09.427Z] [runtime-status] [11320] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:09.428Z] [runtime-status] [11320] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:09.432Z] [runtime-status] [11320] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.434Z] [runtime-status] [11320] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.435Z] [runtime-status] [11320] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.437Z] [runtime-status] [11320] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:09.438Z] [runtime-status] [11320] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.493Z] [runtime-status] [11320] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:09.493Z] [runtime-status] [11320] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:09.493Z] [runtime-status] [11320] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.496Z] [runtime-status] [11320] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.497Z] [runtime-status] [11320] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:09.497Z] [runtime-status] [11320] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:09.505Z] [runtime-status] [11320] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:09.854Z] [runtime-status] [11320] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:09.855Z] [runtime-status] [11320] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:09.855Z] [runtime-status] [11320] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:09.855Z] [runtime-status] [11320] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":""},"createdAt":{"timestampValue":"2021-04-20T18:31:08.744Z"}},"createTime":"2021-04-20T18:31:08.748415Z","updateTime":"2021-04-20T18:31:08.748415Z"},"updateMask":{}},"context":{"eventId":"29c54162-de12-406a-9b12-cd2b7cc8c66c","timestamp":"2021-04-20T18:31:08.748Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:08.744Z\"}},\"createTime\":\"2021-04-20T18:31:08.748415Z\",\"updateTime\":\"2021-04-20T18:31:08.748415Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"29c54162-de12-406a-9b12-cd2b7cc8c66c\",\"timestamp\":\"2021-04-20T18:31:08.748Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:09.856Z] [runtime-status] [11320] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:09.856Z] [runtime-status] [11320] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":""},"createdAt":{"timestampValue":"2021-04-20T18:31:08.744Z"}},"createTime":"2021-04-20T18:31:08.748415Z","updateTime":"2021-04-20T18:31:08.748415Z"},"updateMask":{}},"context":{"eventId":"29c54162-de12-406a-9b12-cd2b7cc8c66c","timestamp":"2021-04-20T18:31:08.748Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:08.744Z\"}},\"createTime\":\"2021-04-20T18:31:08.748415Z\",\"updateTime\":\"2021-04-20T18:31:08.748415Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"29c54162-de12-406a-9b12-cd2b7cc8c66c\",\"timestamp\":\"2021-04-20T18:31:08.748Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1eNgXCedismZVMq3LJoh\"}}"}}
[debug] [2021-04-20T18:31:10.054Z] [runtime-status] [11320] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [11320] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:10.058Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:10.068Z] [worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: exited"}}
[debug] [2021-04-20T18:31:10.068Z] [worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1b555ae2-3d45-4142-915d-7708b3f6d812]: FINISHED"}}
[debug] [2021-04-20T18:31:10.137Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:10.137Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:10.138Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:10.139Z] [worker-pool] Cleaned up workers for detectEvilUsers: 2 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 2 --> 0"}}
[debug] [2021-04-20T18:31:10.143Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:10.144Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:10.144Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:10.144Z] [worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\29924 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\29924"}}
[debug] [2021-04-20T18:31:10.144Z] [worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: BUSY"}}
[debug] [2021-04-20T18:31:10.405Z] [runtime-status] [29924] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:10.407Z] [runtime-status] [29924] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:10.410Z] [runtime-status] [29924] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.412Z] [runtime-status] [29924] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.413Z] [runtime-status] [29924] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.415Z] [runtime-status] [29924] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:10.415Z] [runtime-status] [29924] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.470Z] [runtime-status] [29924] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:10.470Z] [runtime-status] [29924] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:10.471Z] [runtime-status] [29924] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.472Z] [runtime-status] [29924] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.474Z] [runtime-status] [29924] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:10.474Z] [runtime-status] [29924] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:10.482Z] [runtime-status] [29924] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:10.821Z] [runtime-status] [29924] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:10.822Z] [runtime-status] [29924] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:10.822Z] [runtime-status] [29924] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:10.822Z] [runtime-status] [29924] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":""},"createdAt":{"timestampValue":"2021-04-20T18:31:10.068Z"}},"createTime":"2021-04-20T18:31:10.072112Z","updateTime":"2021-04-20T18:31:10.072112Z"},"updateMask":{}},"context":{"eventId":"2446c01c-5204-460b-9cfb-7070986d7009","timestamp":"2021-04-20T18:31:10.072Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:10.068Z\"}},\"createTime\":\"2021-04-20T18:31:10.072112Z\",\"updateTime\":\"2021-04-20T18:31:10.072112Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"2446c01c-5204-460b-9cfb-7070986d7009\",\"timestamp\":\"2021-04-20T18:31:10.072Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:10.822Z] [runtime-status] [29924] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:10.823Z] [runtime-status] [29924] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":""},"createdAt":{"timestampValue":"2021-04-20T18:31:10.068Z"}},"createTime":"2021-04-20T18:31:10.072112Z","updateTime":"2021-04-20T18:31:10.072112Z"},"updateMask":{}},"context":{"eventId":"2446c01c-5204-460b-9cfb-7070986d7009","timestamp":"2021-04-20T18:31:10.072Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:10.068Z\"}},\"createTime\":\"2021-04-20T18:31:10.072112Z\",\"updateTime\":\"2021-04-20T18:31:10.072112Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"2446c01c-5204-460b-9cfb-7070986d7009\",\"timestamp\":\"2021-04-20T18:31:10.072Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/FBmg5u8BBhGhTFTfEOLo\"}}"}}
[debug] [2021-04-20T18:31:11.018Z] [runtime-status] [29924] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29924] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:11.020Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:11.031Z] [worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: exited"}}
[debug] [2021-04-20T18:31:11.031Z] [worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8a901d1c-30b5-4da6-aa7d-5b9add0816b3]: FINISHED"}}
[debug] [2021-04-20T18:31:11.236Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:11.236Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:11.236Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:11.236Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:11.242Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:11.242Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:11.242Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:11.243Z] [worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\3136 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\3136"}}
[debug] [2021-04-20T18:31:11.243Z] [worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: BUSY"}}
[debug] [2021-04-20T18:31:11.515Z] [runtime-status] [3136] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:11.516Z] [runtime-status] [3136] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:11.520Z] [runtime-status] [3136] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.522Z] [runtime-status] [3136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.523Z] [runtime-status] [3136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.524Z] [runtime-status] [3136] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:11.525Z] [runtime-status] [3136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.583Z] [runtime-status] [3136] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:11.583Z] [runtime-status] [3136] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:11.584Z] [runtime-status] [3136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.585Z] [runtime-status] [3136] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.586Z] [runtime-status] [3136] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:11.587Z] [runtime-status] [3136] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:11.597Z] [runtime-status] [3136] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:11.935Z] [runtime-status] [3136] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:11.936Z] [runtime-status] [3136] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:11.936Z] [runtime-status] [3136] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:11.936Z] [runtime-status] [3136] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:11.181Z"}},"createTime":"2021-04-20T18:31:11.184234Z","updateTime":"2021-04-20T18:31:11.184234Z"},"updateMask":{}},"context":{"eventId":"f0d833eb-fc6b-4cee-973f-23b5e724eb70","timestamp":"2021-04-20T18:31:11.184Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:11.181Z\"}},\"createTime\":\"2021-04-20T18:31:11.184234Z\",\"updateTime\":\"2021-04-20T18:31:11.184234Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"f0d833eb-fc6b-4cee-973f-23b5e724eb70\",\"timestamp\":\"2021-04-20T18:31:11.184Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:11.937Z] [runtime-status] [3136] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:11.937Z] [runtime-status] [3136] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:11.181Z"}},"createTime":"2021-04-20T18:31:11.184234Z","updateTime":"2021-04-20T18:31:11.184234Z"},"updateMask":{}},"context":{"eventId":"f0d833eb-fc6b-4cee-973f-23b5e724eb70","timestamp":"2021-04-20T18:31:11.184Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:11.181Z\"}},\"createTime\":\"2021-04-20T18:31:11.184234Z\",\"updateTime\":\"2021-04-20T18:31:11.184234Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"f0d833eb-fc6b-4cee-973f-23b5e724eb70\",\"timestamp\":\"2021-04-20T18:31:11.184Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/hz4QREdK82WnstdeqP98\"}}"}}
[debug] [2021-04-20T18:31:12.145Z] [runtime-status] [3136] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [3136] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:12.148Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:12.158Z] [worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: exited"}}
[debug] [2021-04-20T18:31:12.159Z] [worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5cad170b-eaf4-4ec8-881c-42b06fadbb2b]: FINISHED"}}
[debug] [2021-04-20T18:31:14.599Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:14.599Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:14.599Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:14.599Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:14.605Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:14.606Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:14.606Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:14.606Z] [worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\27176 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\27176"}}
[debug] [2021-04-20T18:31:14.606Z] [worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: BUSY"}}
[debug] [2021-04-20T18:31:14.873Z] [runtime-status] [27176] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:14.874Z] [runtime-status] [27176] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:14.877Z] [runtime-status] [27176] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.879Z] [runtime-status] [27176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.880Z] [runtime-status] [27176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.882Z] [runtime-status] [27176] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:14.883Z] [runtime-status] [27176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.940Z] [runtime-status] [27176] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:14.940Z] [runtime-status] [27176] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:14.940Z] [runtime-status] [27176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.940Z] [runtime-status] [27176] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.941Z] [runtime-status] [27176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:14.941Z] [runtime-status] [27176] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:14.950Z] [runtime-status] [27176] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:15.301Z] [runtime-status] [27176] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:15.301Z] [runtime-status] [27176] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:15.302Z] [runtime-status] [27176] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:15.302Z] [runtime-status] [27176] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:14.542Z"}},"createTime":"2021-04-20T18:31:14.545841Z","updateTime":"2021-04-20T18:31:14.545841Z"},"updateMask":{}},"context":{"eventId":"80820e6d-1ed6-4295-81d9-1ae350a483c8","timestamp":"2021-04-20T18:31:14.545Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:14.542Z\"}},\"createTime\":\"2021-04-20T18:31:14.545841Z\",\"updateTime\":\"2021-04-20T18:31:14.545841Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"80820e6d-1ed6-4295-81d9-1ae350a483c8\",\"timestamp\":\"2021-04-20T18:31:14.545Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:15.302Z] [runtime-status] [27176] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:15.302Z] [runtime-status] [27176] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:14.542Z"}},"createTime":"2021-04-20T18:31:14.545841Z","updateTime":"2021-04-20T18:31:14.545841Z"},"updateMask":{}},"context":{"eventId":"80820e6d-1ed6-4295-81d9-1ae350a483c8","timestamp":"2021-04-20T18:31:14.545Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:14.542Z\"}},\"createTime\":\"2021-04-20T18:31:14.545841Z\",\"updateTime\":\"2021-04-20T18:31:14.545841Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"80820e6d-1ed6-4295-81d9-1ae350a483c8\",\"timestamp\":\"2021-04-20T18:31:14.545Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/To74yjdzWgMQEfu3ePUy\"}}"}}
[debug] [2021-04-20T18:31:15.497Z] [runtime-status] [27176] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [27176] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:15.500Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:15.509Z] [worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: exited"}}
[debug] [2021-04-20T18:31:15.509Z] [worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9136bf24-0960-49bb-99c8-ead5dd3177e4]: FINISHED"}}
[debug] [2021-04-20T18:31:16.544Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:16.544Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:16.544Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:16.544Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:16.549Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:16.549Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:16.549Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:16.549Z] [worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\30688 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\30688"}}
[debug] [2021-04-20T18:31:16.549Z] [worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: BUSY"}}
[debug] [2021-04-20T18:31:16.818Z] [runtime-status] [30688] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:16.819Z] [runtime-status] [30688] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:16.823Z] [runtime-status] [30688] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.824Z] [runtime-status] [30688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.825Z] [runtime-status] [30688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.827Z] [runtime-status] [30688] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:16.828Z] [runtime-status] [30688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.883Z] [runtime-status] [30688] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:16.883Z] [runtime-status] [30688] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:16.883Z] [runtime-status] [30688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.886Z] [runtime-status] [30688] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.887Z] [runtime-status] [30688] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:16.887Z] [runtime-status] [30688] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:16.895Z] [runtime-status] [30688] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:17.242Z] [runtime-status] [30688] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:17.243Z] [runtime-status] [30688] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:17.243Z] [runtime-status] [30688] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:17.243Z] [runtime-status] [30688] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:16.493Z"}},"createTime":"2021-04-20T18:31:16.496110Z","updateTime":"2021-04-20T18:31:16.496110Z"},"updateMask":{}},"context":{"eventId":"43804434-db3d-48fc-a0fc-044a3c69da56","timestamp":"2021-04-20T18:31:16.496Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:16.493Z\"}},\"createTime\":\"2021-04-20T18:31:16.496110Z\",\"updateTime\":\"2021-04-20T18:31:16.496110Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"43804434-db3d-48fc-a0fc-044a3c69da56\",\"timestamp\":\"2021-04-20T18:31:16.496Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:17.243Z] [runtime-status] [30688] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:17.243Z] [runtime-status] [30688] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:16.493Z"}},"createTime":"2021-04-20T18:31:16.496110Z","updateTime":"2021-04-20T18:31:16.496110Z"},"updateMask":{}},"context":{"eventId":"43804434-db3d-48fc-a0fc-044a3c69da56","timestamp":"2021-04-20T18:31:16.496Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:16.493Z\"}},\"createTime\":\"2021-04-20T18:31:16.496110Z\",\"updateTime\":\"2021-04-20T18:31:16.496110Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"43804434-db3d-48fc-a0fc-044a3c69da56\",\"timestamp\":\"2021-04-20T18:31:16.496Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/5PC2lqzrajtV7ozcq0OI\"}}"}}
[debug] [2021-04-20T18:31:17.450Z] [runtime-status] [30688] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [30688] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:17.454Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:17.464Z] [worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: exited"}}
[debug] [2021-04-20T18:31:17.464Z] [worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-1728e37b-a434-4c88-9abb-6421aa14c5dc]: FINISHED"}}
[debug] [2021-04-20T18:31:18.137Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:18.138Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:18.138Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:18.138Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:18.142Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:18.143Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:18.143Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:18.143Z] [worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\29620 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\29620"}}
[debug] [2021-04-20T18:31:18.143Z] [worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: BUSY"}}
[debug] [2021-04-20T18:31:18.406Z] [runtime-status] [29620] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:18.407Z] [runtime-status] [29620] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:18.410Z] [runtime-status] [29620] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.412Z] [runtime-status] [29620] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.413Z] [runtime-status] [29620] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.415Z] [runtime-status] [29620] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:18.415Z] [runtime-status] [29620] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.469Z] [runtime-status] [29620] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:18.469Z] [runtime-status] [29620] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:18.470Z] [runtime-status] [29620] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.471Z] [runtime-status] [29620] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.473Z] [runtime-status] [29620] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:18.473Z] [runtime-status] [29620] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:18.481Z] [runtime-status] [29620] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:18.815Z] [runtime-status] [29620] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:18.816Z] [runtime-status] [29620] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:18.816Z] [runtime-status] [29620] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:18.817Z] [runtime-status] [29620] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:18.095Z"}},"createTime":"2021-04-20T18:31:18.097609Z","updateTime":"2021-04-20T18:31:18.097609Z"},"updateMask":{}},"context":{"eventId":"1bd33445-33d0-453e-bf4f-57147c183543","timestamp":"2021-04-20T18:31:18.097Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:18.095Z\"}},\"createTime\":\"2021-04-20T18:31:18.097609Z\",\"updateTime\":\"2021-04-20T18:31:18.097609Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"1bd33445-33d0-453e-bf4f-57147c183543\",\"timestamp\":\"2021-04-20T18:31:18.097Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:18.817Z] [runtime-status] [29620] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:18.817Z] [runtime-status] [29620] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:18.095Z"}},"createTime":"2021-04-20T18:31:18.097609Z","updateTime":"2021-04-20T18:31:18.097609Z"},"updateMask":{}},"context":{"eventId":"1bd33445-33d0-453e-bf4f-57147c183543","timestamp":"2021-04-20T18:31:18.097Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:18.095Z\"}},\"createTime\":\"2021-04-20T18:31:18.097609Z\",\"updateTime\":\"2021-04-20T18:31:18.097609Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"1bd33445-33d0-453e-bf4f-57147c183543\",\"timestamp\":\"2021-04-20T18:31:18.097Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/fU8JoegKGknDohZ0U52j\"}}"}}
[debug] [2021-04-20T18:31:19.019Z] [runtime-status] [29620] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [29620] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:19.022Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:19.031Z] [worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: exited"}}
[debug] [2021-04-20T18:31:19.031Z] [worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-84ce4ae7-a39d-4e74-8ed8-9c743be187b8]: FINISHED"}}
[debug] [2021-04-20T18:31:19.644Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:19.645Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:19.645Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:19.645Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:19.650Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:19.650Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:19.650Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:19.651Z] [worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\21048 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\21048"}}
[debug] [2021-04-20T18:31:19.651Z] [worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: BUSY"}}
[debug] [2021-04-20T18:31:19.926Z] [runtime-status] [21048] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:19.928Z] [runtime-status] [21048] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:19.931Z] [runtime-status] [21048] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.933Z] [runtime-status] [21048] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.934Z] [runtime-status] [21048] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.936Z] [runtime-status] [21048] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:19.937Z] [runtime-status] [21048] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.994Z] [runtime-status] [21048] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:19.994Z] [runtime-status] [21048] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:19.994Z] [runtime-status] [21048] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.997Z] [runtime-status] [21048] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.998Z] [runtime-status] [21048] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:19.998Z] [runtime-status] [21048] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:20.006Z] [runtime-status] [21048] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:20.345Z] [runtime-status] [21048] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:20.346Z] [runtime-status] [21048] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:20.346Z] [runtime-status] [21048] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:20.347Z] [runtime-status] [21048] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:19.596Z"}},"createTime":"2021-04-20T18:31:19.599065Z","updateTime":"2021-04-20T18:31:19.599065Z"},"updateMask":{}},"context":{"eventId":"de6c2302-527d-4419-8625-f27e1c1c878e","timestamp":"2021-04-20T18:31:19.599Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:19.596Z\"}},\"createTime\":\"2021-04-20T18:31:19.599065Z\",\"updateTime\":\"2021-04-20T18:31:19.599065Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"de6c2302-527d-4419-8625-f27e1c1c878e\",\"timestamp\":\"2021-04-20T18:31:19.599Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:20.347Z] [runtime-status] [21048] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:20.347Z] [runtime-status] [21048] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:19.596Z"}},"createTime":"2021-04-20T18:31:19.599065Z","updateTime":"2021-04-20T18:31:19.599065Z"},"updateMask":{}},"context":{"eventId":"de6c2302-527d-4419-8625-f27e1c1c878e","timestamp":"2021-04-20T18:31:19.599Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:19.596Z\"}},\"createTime\":\"2021-04-20T18:31:19.599065Z\",\"updateTime\":\"2021-04-20T18:31:19.599065Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"de6c2302-527d-4419-8625-f27e1c1c878e\",\"timestamp\":\"2021-04-20T18:31:19.599Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/1Ap2BQCyCupEniaUuM23\"}}"}}
[debug] [2021-04-20T18:31:20.553Z] [runtime-status] [21048] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [21048] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:20.556Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:20.565Z] [worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: exited"}}
[debug] [2021-04-20T18:31:20.565Z] [worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-5604710f-43ee-4c5c-b697-acda036dea5f]: FINISHED"}}
[debug] [2021-04-20T18:31:20.613Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:20.614Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:20.614Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:20.614Z] [worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Cleaned up workers for detectEvilUsers: 1 --> 0"}}
[debug] [2021-04-20T18:31:20.619Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:20.619Z] [worker-pool] Adding worker with key detectEvilUsers, total=1 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=1"}}
[debug] [2021-04-20T18:31:20.619Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:20.619Z] [worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\28176 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\28176"}}
[debug] [2021-04-20T18:31:20.619Z] [worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: BUSY"}}
[debug] [2021-04-20T18:31:20.892Z] [runtime-status] [28176] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:20.894Z] [runtime-status] [28176] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:20.897Z] [runtime-status] [28176] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.899Z] [runtime-status] [28176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.900Z] [runtime-status] [28176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.902Z] [runtime-status] [28176] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:20.903Z] [runtime-status] [28176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.959Z] [runtime-status] [28176] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:20.960Z] [runtime-status] [28176] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:20.960Z] [runtime-status] [28176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.961Z] [runtime-status] [28176] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.964Z] [runtime-status] [28176] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:20.964Z] [runtime-status] [28176] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:20.972Z] [runtime-status] [28176] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:21.310Z] [runtime-status] [28176] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:21.311Z] [runtime-status] [28176] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:21.311Z] [runtime-status] [28176] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:21.311Z] [runtime-status] [28176] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:20.569Z"}},"createTime":"2021-04-20T18:31:20.572887Z","updateTime":"2021-04-20T18:31:20.572887Z"},"updateMask":{}},"context":{"eventId":"158688b0-e1bd-49dd-b41e-441515615747","timestamp":"2021-04-20T18:31:20.572Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:20.569Z\"}},\"createTime\":\"2021-04-20T18:31:20.572887Z\",\"updateTime\":\"2021-04-20T18:31:20.572887Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"158688b0-e1bd-49dd-b41e-441515615747\",\"timestamp\":\"2021-04-20T18:31:20.572Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:21.312Z] [runtime-status] [28176] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:21.312Z] [runtime-status] [28176] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:20.569Z"}},"createTime":"2021-04-20T18:31:20.572887Z","updateTime":"2021-04-20T18:31:20.572887Z"},"updateMask":{}},"context":{"eventId":"158688b0-e1bd-49dd-b41e-441515615747","timestamp":"2021-04-20T18:31:20.572Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:20.569Z\"}},\"createTime\":\"2021-04-20T18:31:20.572887Z\",\"updateTime\":\"2021-04-20T18:31:20.572887Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"158688b0-e1bd-49dd-b41e-441515615747\",\"timestamp\":\"2021-04-20T18:31:20.572Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/DVb3Rdmfp6Lddcb9cVmG\"}}"}}
[debug] [2021-04-20T18:31:21.516Z] [runtime-status] [28176] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [28176] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:21.519Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:21.523Z] [work-queue] {"queueLength":1,"workRunningCount":0}
[debug] [2021-04-20T18:31:21.523Z] [work-queue] {"queueLength":0,"workRunningCount":1}
[debug] [2021-04-20T18:31:21.523Z] Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0 {"metadata":{"emulator":{"name":"functions"},"message":"Accepted request POST /functions/projects/stream-site-9ebd9/triggers/detectEvilUsers-0 --> detectEvilUsers-0"}}
[debug] [2021-04-20T18:31:21.527Z] [worker-pool] addWorker(detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] addWorker(detectEvilUsers)"}}
[debug] [2021-04-20T18:31:21.528Z] [worker-pool] Adding worker with key detectEvilUsers, total=2 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] Adding worker with key detectEvilUsers, total=2"}}
[debug] [2021-04-20T18:31:21.528Z] [worker-pool] submitWork(triggerId=detectEvilUsers) {"metadata":{"emulator":{"name":"functions"},"message":"[worker-pool] submitWork(triggerId=detectEvilUsers)"}}
[debug] [2021-04-20T18:31:21.528Z] [worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: Assigning socketPath: \\?\pipe\C:\Users\Joe\Source\Repos\react-firebase-chat\functions\12988 {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: Assigning socketPath: \\\\?\\pipe\\C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\12988"}}
[debug] [2021-04-20T18:31:21.528Z] [worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: BUSY {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: BUSY"}}
[debug] [2021-04-20T18:31:21.529Z] [worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: exited"}}
[debug] [2021-04-20T18:31:21.529Z] [worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-8cfa641a-bf3a-430c-89b8-f10b0678ed4a]: FINISHED"}}
[debug] [2021-04-20T18:31:21.793Z] [runtime-status] [12988] Functions runtime initialized. {"cwd":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions","node_version":"12.18.4"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Functions runtime initialized. {\"cwd\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\",\"node_version\":\"12.18.4\"}"}}
[debug] [2021-04-20T18:31:21.794Z] [runtime-status] [12988] Disabled runtime features: undefined {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Disabled runtime features: undefined"}}
[debug] [2021-04-20T18:31:21.798Z] [runtime-status] [12988] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.800Z] [runtime-status] [12988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.801Z] [runtime-status] [12988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.803Z] [runtime-status] [12988] Outgoing network have been stubbed. [{"name":"http","status":"mocked"},{"name":"http","status":"mocked"},{"name":"https","status":"mocked"},{"name":"https","status":"mocked"},{"name":"net","status":"mocked"}] {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Outgoing network have been stubbed. [{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"http\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"https\",\"status\":\"mocked\"},{\"name\":\"net\",\"status\":\"mocked\"}]"}}
[debug] [2021-04-20T18:31:21.803Z] [runtime-status] [12988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.859Z] [runtime-status] [12988] Checked functions.config() {"config":{}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Checked functions.config() {\"config\":{}}"}}
[debug] [2021-04-20T18:31:21.859Z] [runtime-status] [12988] firebase-functions has been stubbed. {"functionsResolution":{"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] firebase-functions has been stubbed. {\"functionsResolution\":{\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:21.859Z] [runtime-status] [12988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.861Z] [runtime-status] [12988] Resolved module firebase-admin {"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-admin {\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.863Z] [runtime-status] [12988] Resolved module firebase-functions {"declared":true,"installed":true,"version":"3.13.2","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-functions\\lib\\index.js"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Resolved module firebase-functions {\"declared\":true,\"installed\":true,\"version\":\"3.13.2\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-functions\\\\lib\\\\index.js\"}"}}
[debug] [2021-04-20T18:31:21.863Z] [runtime-status] [12988] firebase-admin has been stubbed. {"adminResolution":{"declared":true,"installed":true,"version":"9.6.0","resolution":"C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\node_modules\\firebase-admin\\lib\\index.js"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] firebase-admin has been stubbed. {\"adminResolution\":{\"declared\":true,\"installed\":true,\"version\":\"9.6.0\",\"resolution\":\"C:\\\\Users\\\\Joe\\\\Source\\\\Repos\\\\react-firebase-chat\\\\functions\\\\node_modules\\\\firebase-admin\\\\lib\\\\index.js\"}}"}}
[debug] [2021-04-20T18:31:21.872Z] [runtime-status] [12988] initializeApp(DEFAULT) {"storageBucket":"stream-site-9ebd9.appspot.com","projectId":"stream-site-9ebd9"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] initializeApp(DEFAULT) {\"storageBucket\":\"stream-site-9ebd9.appspot.com\",\"projectId\":\"stream-site-9ebd9\"}"}}
[debug] [2021-04-20T18:31:22.219Z] [runtime-status] [12988] Trigger "detectEvilUsers" has been found, beginning invocation! {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Trigger \"detectEvilUsers\" has been found, beginning invocation!"}}
[info] i  functions: Beginning execution of "detectEvilUsers" {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Beginning execution of \"detectEvilUsers\""}}
[debug] [2021-04-20T18:31:22.220Z] [runtime-status] [12988] triggerDefinition {"eventTrigger":{"resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}","eventType":"providers/cloud.firestore/eventTypes/document.create","service":"firestore.googleapis.com"},"name":"detectEvilUsers","entryPoint":"detectEvilUsers"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] triggerDefinition {\"eventTrigger\":{\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/{msgId}\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"service\":\"firestore.googleapis.com\"},\"name\":\"detectEvilUsers\",\"entryPoint\":\"detectEvilUsers\"}"}}
[debug] [2021-04-20T18:31:22.220Z] [runtime-status] [12988] Running detectEvilUsers in mode BACKGROUND {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Running detectEvilUsers in mode BACKGROUND"}}
[debug] [2021-04-20T18:31:22.221Z] [runtime-status] [12988] ProcessBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:21.382Z"}},"createTime":"2021-04-20T18:31:21.384270Z","updateTime":"2021-04-20T18:31:21.384270Z"},"updateMask":{}},"context":{"eventId":"636bd0b5-fe11-470c-86c0-655c705f278a","timestamp":"2021-04-20T18:31:21.384Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh","service":"firestore.googleapis.com"}}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] ProcessBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:21.382Z\"}},\"createTime\":\"2021-04-20T18:31:21.384270Z\",\"updateTime\":\"2021-04-20T18:31:21.384270Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"636bd0b5-fe11-470c-86c0-655c705f278a\",\"timestamp\":\"2021-04-20T18:31:21.384Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh\",\"service\":\"firestore.googleapis.com\"}}}"}}
[debug] [2021-04-20T18:31:22.221Z] [runtime-status] [12988] ProcessBackground: lifting resource.name from resource {"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh","service":"firestore.googleapis.com"} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] ProcessBackground: lifting resource.name from resource {\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh\",\"service\":\"firestore.googleapis.com\"}"}}
[debug] [2021-04-20T18:31:22.221Z] [runtime-status] [12988] RunBackground {"data":{"value":{"name":"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh","fields":{"uid":{"stringValue":"91uPOOT77PKb3e4lV9WBO1l2IBsu"},"photoURL":{"nullValue":null},"text":{"stringValue":"test"},"createdAt":{"timestampValue":"2021-04-20T18:31:21.382Z"}},"createTime":"2021-04-20T18:31:21.384270Z","updateTime":"2021-04-20T18:31:21.384270Z"},"updateMask":{}},"context":{"eventId":"636bd0b5-fe11-470c-86c0-655c705f278a","timestamp":"2021-04-20T18:31:21.384Z","eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh"}} {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] RunBackground {\"data\":{\"value\":{\"name\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh\",\"fields\":{\"uid\":{\"stringValue\":\"91uPOOT77PKb3e4lV9WBO1l2IBsu\"},\"photoURL\":{\"nullValue\":null},\"text\":{\"stringValue\":\"test\"},\"createdAt\":{\"timestampValue\":\"2021-04-20T18:31:21.382Z\"}},\"createTime\":\"2021-04-20T18:31:21.384270Z\",\"updateTime\":\"2021-04-20T18:31:21.384270Z\"},\"updateMask\":{}},\"context\":{\"eventId\":\"636bd0b5-fe11-470c-86c0-655c705f278a\",\"timestamp\":\"2021-04-20T18:31:21.384Z\",\"eventType\":\"providers/cloud.firestore/eventTypes/document.create\",\"resource\":\"projects/stream-site-9ebd9/databases/(default)/documents/messages/9jGzzbrtXJml7xepl2zh\"}}"}}
[debug] [2021-04-20T18:31:22.413Z] [runtime-status] [12988] Ephemeral server survived. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"[runtime-status] [12988] Ephemeral server survived."}}
[warn] !  functions: TypeError: Cannot read property 'msgCount' of undefined
    at C:\Users\Joe\Source\Repos\react-firebase-chat\functions\index.js:28:22
    at processTicksAndRejections (internal/process/task_queues.js:97:5)
    at async runFunction (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:579:9)
    at async runBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:591:5)
    at async processBackground (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:574:5)
    at async invokeTrigger (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:649:13)
    at async handleMessage (C:\Users\Joe\AppData\Roaming\npm\node_modules\firebase-tools\lib\emulator\functionsEmulatorRuntime.js:736:9) {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"TypeError: Cannot read property 'msgCount' of undefined\n    at C:\\Users\\Joe\\Source\\Repos\\react-firebase-chat\\functions\\index.js:28:22\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\n    at async runFunction (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:579:9)\n    at async runBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:591:5)\n    at async processBackground (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:574:5)\n    at async invokeTrigger (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:649:13)\n    at async handleMessage (C:\\Users\\Joe\\AppData\\Roaming\\npm\\node_modules\\firebase-tools\\lib\\emulator\\functionsEmulatorRuntime.js:736:9)"}}
[warn] !  Your function was killed because it raised an unhandled error. {"metadata":{"emulator":{"name":"functions"},"function":{"name":"detectEvilUsers"},"message":"Your function was killed because it raised an unhandled error."}}
[debug] [2021-04-20T18:31:22.417Z] [work-queue] {"queueLength":0,"workRunningCount":0}
[debug] [2021-04-20T18:31:22.427Z] [worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: exited {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: exited"}}
[debug] [2021-04-20T18:31:22.427Z] [worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: FINISHED {"metadata":{"emulator":{"name":"functions"},"message":"[worker-detectEvilUsers-9d91bd8f-1962-4473-a987-9c5aa3021e55]: FINISHED"}}
