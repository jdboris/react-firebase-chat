(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1113:function(module,exports,__webpack_require__){var api=__webpack_require__(248),content=__webpack_require__(1114);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},1114:function(module,exports,__webpack_require__){(exports=__webpack_require__(249)(!1)).push([module.i,'/* [data-provider] {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n} */\n\n/* Put a line break before the first embed of a group and after the last one */\n[data-provider]:first-child::before {\n  content: "";\n  display: block;\n}\n\n[data-provider]:last-child::after {\n  content: "";\n  display: block;\n}\n\n/* Youtube */\n[data-provider="YouTube"] iframe {\n  min-width: 300px;\n  min-height: 168.75px;\n}\n\n/* Twitter */\n[data-provider="Twitter"] blockquote.twitter-tweet {\n  display: inline-block;\n  font-family: "Helvetica Neue", Roboto, "Segoe UI", Calibri, sans-serif;\n  font-size: 12px;\n  font-weight: bold;\n  line-height: 16px;\n  border-color: #eee #ddd #bbb;\n  border-radius: 5px;\n  border-style: solid;\n  border-width: 1px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);\n  margin: 10px 5px;\n  padding: 0 16px 16px 16px;\n  min-height: initial;\n  max-width: 600px;\n}\n\n[data-provider="Twitter"] p {\n  font-size: 16px;\n  font-weight: normal;\n  line-height: 20px;\n  margin: 16px 0px;\n  display: block;\n}\n\n[data-provider="Twitter"] blockquote.twitter-tweet a {\n  color: #1b95e0;\n  font-weight: normal;\n  text-decoration: none;\n  outline: 0 none;\n}\n\n[data-provider="Twitter"] blockquote.twitter-tweet a:hover,\n[data-provider="Twitter"] blockquote.twitter-tweet a:focus {\n  text-decoration: underline;\n}\n',""]),module.exports=exports},1128:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,"parameters",(function(){return parameters}));__webpack_require__(33),__webpack_require__(7),__webpack_require__(57),__webpack_require__(491),__webpack_require__(949),__webpack_require__(65),__webpack_require__(950),__webpack_require__(951),__webpack_require__(490);var client_api=__webpack_require__(1148),esm=__webpack_require__(12),parameters={actions:{argTypesRegex:"^on[A-Z].*"},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return Object(client_api.c)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return Object(client_api.d)(loader,!1)}));case"parameters":return Object(client_api.e)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return Object(client_api.a)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return Object(client_api.b)(enhancer)}));case"render":return Object(client_api.g)(value);case"globals":case"globalTypes":var v={};return v[key]=value,Object(client_api.e)(v,!1);default:return console.log(key+" was not supported :( !")}}))},272:function(module,exports,__webpack_require__){var api=__webpack_require__(248),content=__webpack_require__(973);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},5:function(module,exports,__webpack_require__){var api=__webpack_require__(248),content=__webpack_require__(958);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},576:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return firestore})),__webpack_require__.d(__webpack_exports__,"b",(function(){return auth})),__webpack_require__.d(__webpack_exports__,"d",(function(){return conversationsRef})),__webpack_require__.d(__webpack_exports__,"i",(function(){return usersRef})),__webpack_require__.d(__webpack_exports__,"f",(function(){return modActionLogRef})),__webpack_require__.d(__webpack_exports__,"g",(function(){return settingsRef})),__webpack_require__.d(__webpack_exports__,"c",(function(){return banUser})),__webpack_require__.d(__webpack_exports__,"h",(function(){return unbanUser})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ChatRoomApp}));__webpack_require__(41),__webpack_require__(11),__webpack_require__(138),__webpack_require__(18),__webpack_require__(15),__webpack_require__(17),__webpack_require__(77),__webpack_require__(247),__webpack_require__(57),__webpack_require__(80),__webpack_require__(35),__webpack_require__(59),__webpack_require__(7),__webpack_require__(14),__webpack_require__(20),__webpack_require__(19),__webpack_require__(8),__webpack_require__(25),__webpack_require__(1121);var dist_index_esm=__webpack_require__(30),react=(__webpack_require__(956),__webpack_require__(1129),__webpack_require__(1123),__webpack_require__(1124),__webpack_require__(0)),react_firebase_hooks_auth_dist_index_esm=__webpack_require__(561),Close=(__webpack_require__(27),__webpack_require__(44)),Close_default=__webpack_require__.n(Close),chat_room_module=__webpack_require__(5),chat_room_module_default=__webpack_require__.n(chat_room_module),jsx_runtime=__webpack_require__(2);function AlertDialog(props){return props.alerts.length>0&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["error-dialog"],children:[Object(jsx_runtime.jsxs)("header",{children:[Object(jsx_runtime.jsx)("span",{}),Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){props.requestClose()}})]}),Object(jsx_runtime.jsx)("main",{children:props.alerts.map((function(alert,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.alert,children:alert},i)}))}),Object(jsx_runtime.jsx)("footer",{})]})}AlertDialog.__docgenInfo={description:"",methods:[],displayName:"AlertDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\alert-dialog.jsx"]={name:"AlertDialog",docgenInfo:AlertDialog.__docgenInfo,path:"src\\components\\alert-dialog.jsx"});__webpack_require__(26),__webpack_require__(71),__webpack_require__(150);var ChatBubble=__webpack_require__(573),ChatBubble_default=__webpack_require__.n(ChatBubble),Gavel=__webpack_require__(574),Gavel_default=__webpack_require__.n(Gavel),Menu=__webpack_require__(575),Menu_default=__webpack_require__.n(Menu),react_firebase_hooks_firestore_dist_index_esm=__webpack_require__(84),fonts=[{name:"Arial",style:"Arial, Helvetica, sans-serif"},{name:"Comic",style:'"Comic Sans MS", "Comic Sans", cursive'},{name:"Georgia",style:'Georgia, Times, "Times New Roman", serif'},{name:"Handwriting",style:'"Lucida Handwriting", Zapfino, Chalkduster, cursive'},{name:"Impact",style:'Impact, Haettenschweiler, "Franklin Gothic Bold", Charcoal, "Helvetica Inserat", "Bitstream Vera Sans Bold", "Arial Black", "sans serif"'},{name:"Palatino",style:'Palatino, "Palatino Linotype", "Palatino LT STD", "Book Antiqua", Georgia, serif'},{name:"Papyrus",style:"Papyrus, fantasy"},{name:"Times",style:'"Times New Roman", Times, serif'},{name:"Typewriter",style:'"Lucida Sans Typewriter", "Lucida Console", monaco, "Bitstream Vera Sans Mono", monospace'}];__webpack_require__(136),__webpack_require__(142),__webpack_require__(64),__webpack_require__(961),__webpack_require__(81),__webpack_require__(88),__webpack_require__(56);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MARKUP_SYMBOLS={BOLD:"**",ITALICS:"*",UNDERLINE:"_"},MARKUP_CHARACTERS=new Set(Object.values(MARKUP_SYMBOLS).reduce((function(a,b){return a+b})));function markdown_toggleSelectionMarkup(element,symbol){var value=element.value,start=element.selectionStart,end=element.selectionEnd,frontMarkup=start===end?function getMarkupBefore(string,index){var firstHalf=string.substring(0,index),markup=getMarkupAround(firstHalf,Math.max(firstHalf.length-1,0));return markup.end=index,markup.start=markup.end-markup.value.length,markup}(value,start):getMarkupAround(value,start),backMarkup=start===end?function getMarkupAfter(string,index){var markup=getMarkupAround(string.substring(index),0);return markup.start=index,markup.end=markup.start+markup.value.length,markup}(value,end):getMarkupAround(value,end),beforeMarkup=value.substring(0,frontMarkup.start),middleValue=value.substring(frontMarkup.end,backMarkup.start),afterMarkup=value.substring(backMarkup.end);return frontMarkup.value=toggleSymbolInMarkup(frontMarkup.value,symbol),backMarkup.value=reverse(toggleSymbolInMarkup(reverse(backMarkup.value),symbol)),{value:[beforeMarkup,frontMarkup.value,middleValue,backMarkup.value,afterMarkup].join(""),start:beforeMarkup.length+frontMarkup.value.length,end:beforeMarkup.length+frontMarkup.value.length+middleValue.length}}function reverse(s){return _toConsumableArray(s).reverse().join("")}function toggleSymbolInMarkup(markup,symbol){var newMarkup=markup,leftovers="";for(var key in MARKUP_SYMBOLS){if(MARKUP_SYMBOLS[key]===symbol)break;newMarkup.includes(MARKUP_SYMBOLS[key])&&(leftovers+=MARKUP_SYMBOLS[key],newMarkup=newMarkup.replace(MARKUP_SYMBOLS[key],""))}return newMarkup.includes(symbol)?leftovers+(newMarkup=newMarkup.replace(symbol,"")):leftovers+symbol+newMarkup}function getMarkupAround(string,index){for(var markup={start:index,end:index,value:""},i=index-1;i>=0&&MARKUP_CHARACTERS.has(string[i]);i--)markup.start-=1,markup.value=string[i]+markup.value;for(var _i=index;_i<string.length&&MARKUP_CHARACTERS.has(string[_i]);_i++)markup.end+=1,markup.value+=string[_i];return markup}__webpack_require__(199),__webpack_require__(1130);function timeout(durationInMs,asyncFunction){return Promise.race([asyncFunction(),new Promise((function(resolve,reject){setTimeout((function(){resolve("Promise timed out after "+durationInMs+"ms.")}),durationInMs)}))])}function setQueryParam(key,value){var url=new URL(window.location);null===value?url.searchParams.delete(key):url.searchParams.set(key,value);var queryString=url.searchParams.toString(),hash=window.location.hash;window.history.replaceState({},"",window.location.pathname+(queryString?"?"+queryString:"")+hash)}var react_paginate=__webpack_require__(113),react_paginate_default=__webpack_require__.n(react_paginate),pagination_controls_module=__webpack_require__(63),pagination_controls_module_default=__webpack_require__.n(pagination_controls_module);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function banlist_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return banlist_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return banlist_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function banlist_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function BanlistDialog(props){var _useState2=_slicedToArray(Object(react.useState)(""),2),username=_useState2[0],setUsername=_useState2[1],_useState4=_slicedToArray(Object(react.useState)([]),2),errors=_useState4[0],setErrors=_useState4[1],query=props.open?usersRef.orderBy("lowercaseUsername").where("isBanned","==",!0):null,bannedUsers=_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.a)(query,{idField:"id"}),1)[0],_useState6=_slicedToArray(Object(react.useState)(1),2),page=_useState6[0],setPage=_useState6[1],start=10*(page-1),end=10*page;return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a.moderators,children:[Object(jsx_runtime.jsxs)("header",{children:["Banlist",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setUsername(""),setErrors([]),props.requestClose()}})]}),Object(jsx_runtime.jsxs)("main",{children:[bannedUsers&&bannedUsers.slice(start,end).map((function(user,i){return Object(jsx_runtime.jsxs)("div",{children:[user.username," ",Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,unbanUser(user.username);case 2:(result=_context.sent).data.error?setErrors([result.data.error]):setErrors([]);case 4:case"end":return _context.stop()}}),_callee)}))),children:"remove"})]},i)})),Object(jsx_runtime.jsxs)("form",{onSubmit:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){var result;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return e.preventDefault(),_context2.next=3,banUser(username);case 3:(result=_context2.sent).data.error?setErrors([result.data.error]):setErrors([]);case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),children:[errors.map((function(error,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.error,children:error},i)})),Object(jsx_runtime.jsx)("input",{type:"text",placeholder:"Username",onInput:function onInput(e){setUsername(e.target.value)},value:username})," ",Object(jsx_runtime.jsx)("button",{children:"Ban"})]})]}),Object(jsx_runtime.jsx)("footer",{className:pagination_controls_module_default.a["pagination-controls"],children:bannedUsers&&Object(jsx_runtime.jsx)(react_paginate_default.a,{pageCount:Math.ceil(bannedUsers.length/10),pageRangeDisplayed:10,marginPagesDisplayed:2,onPageChange:function onPageChange(item){setPage(item.selected+1)},nextLabel:">",previousLabel:"<",disabledClassName:pagination_controls_module_default.a.disabled,activeClassName:pagination_controls_module_default.a.selected})})]})}BanlistDialog.__docgenInfo={description:"",methods:[],displayName:"BanlistDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\banlist-dialog.jsx"]={name:"BanlistDialog",docgenInfo:BanlistDialog.__docgenInfo,path:"src\\components\\banlist-dialog.jsx"});__webpack_require__(500);function translateError(error){return error.code?(("auth/wrong-password"===error.code||"auth/user-not-found"===error.code)&&(error.message="Invalid email/password."),error.message||(error.message="Something went wrong. Please try again."),error):error}function dms_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function dms_dialog_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){dms_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){dms_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function dms_dialog_slicedToArray(arr,i){return function dms_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function dms_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function dms_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return dms_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dms_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function dms_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dms_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function DmsDialog(props){var conversations=props.conversations,_useState2=dms_dialog_slicedToArray(Object(react.useState)(""),2),username=_useState2[0],setUsername=_useState2[1],_useState4=dms_dialog_slicedToArray(Object(react.useState)([]),2),errors=_useState4[0],setErrors=_useState4[1],_useState6=dms_dialog_slicedToArray(Object(react.useState)(1),2),page=_useState6[0],setPage=_useState6[1],_useState8=dms_dialog_slicedToArray(Object(react.useState)(!1),2),loading=_useState8[0],setLoading=_useState8[1],itemsPerPage=props.itemsPerPage,start=(page-1)*itemsPerPage,end=page*itemsPerPage,combineStrings=function combineStrings(strings){return strings.sort(),strings.join(":")};return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog,children:[Object(jsx_runtime.jsxs)("header",{children:["Conversations",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setUsername(""),setErrors([]),props.requestClose()}})]}),Object(jsx_runtime.jsxs)("main",{children:[Object(jsx_runtime.jsx)("ul",{children:conversations&&conversations.slice(start,end).map((function(conversation,i){var lastReadAt=conversation.users[props.uid].lastReadAt,isUnread=!1;return null!==lastReadAt&&(isUnread=conversation.lastMessageSentAt>lastReadAt),Object(jsx_runtime.jsx)("li",{children:Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link+" "+(isUnread?chat_room_module_default.a["unread-conversation"]:""),onClick:dms_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,props.setConversationRef(firestore.collection("conversations").doc(conversation.id));case 2:return _context.next=4,props.setDmMessagesRef(firestore.collection("conversations").doc(conversation.id).collection("messages"));case 4:props.requestClose();case 5:case"end":return _context.stop()}}),_callee)}))),children:conversation.id.split(":").filter((function(e){return e!==props.username})).toString()})},i)}))}),Object(jsx_runtime.jsxs)("form",{onSubmit:function(){var _ref2=dms_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee3(e){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:e.preventDefault(),setLoading(!0),setErrors([]),timeout(5e3,dms_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _users,snapshot,conversationId;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(username){_context2.next=2;break}throw new Error("Enter a username.");case 2:return _context2.next=4,usersRef.where("lowercaseUsername","==",username.toLowerCase()).get();case 4:if((snapshot=_context2.sent).docs.length){_context2.next=7;break}throw new Error("User not found.");case 7:if(snapshot.docs[0].id!==props.uid){_context2.next=9;break}throw new Error("Cannot chat with yourself.");case 9:return conversationId=combineStrings([props.username,snapshot.docs[0].data().username]),_context2.next=12,conversationsRef.doc(conversationId).set({lastMessageSentAt:0,userIds:[props.uid,snapshot.docs[0].id],users:(_users={},_users[props.uid]={lastReadAt:dist_index_esm.a.firestore.FieldValue.serverTimestamp()},_users[snapshot.docs[0].id]={lastReadAt:dist_index_esm.a.firestore.FieldValue.serverTimestamp()},_users)},{merge:!0});case 12:return _context2.next=14,props.setConversationRef(firestore.collection("conversations").doc(conversationId));case 14:return _context2.next=16,props.setDmMessagesRef(firestore.collection("conversations").doc(conversationId).collection("messages"));case 16:props.requestClose();case 17:case"end":return _context2.stop()}}),_callee2)})))).then((function(){setLoading(!1),props.requestClose()})).catch((function(error){setLoading(!1),"permission-denied"!==error.code?setErrors([translateError(error).message]):setErrors(["Verify your email to do that."])}));case 4:case"end":return _context3.stop()}}),_callee3)})));return function(_x){return _ref2.apply(this,arguments)}}(),children:[errors.map((function(error,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.error,children:error},i)})),Object(jsx_runtime.jsx)("input",{type:"text",placeholder:"Username",onInput:function onInput(e){setUsername(e.target.value)},value:username})," ",Object(jsx_runtime.jsx)("button",{className:loading?chat_room_module_default.a.loading:"",children:"Start Conversation"})]})]}),Object(jsx_runtime.jsx)("footer",{className:pagination_controls_module_default.a["pagination-controls"],children:conversations&&Object(jsx_runtime.jsx)(react_paginate_default.a,{pageCount:Math.ceil(conversations.length/itemsPerPage),pageRangeDisplayed:10,marginPagesDisplayed:2,onPageChange:function onPageChange(item){setPage(item.selected+1)},nextLabel:">",previousLabel:"<",disabledClassName:pagination_controls_module_default.a.disabled,activeClassName:pagination_controls_module_default.a.selected})})]})}DmsDialog.__docgenInfo={description:"",methods:[],displayName:"DmsDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\dms-dialog.jsx"]={name:"DmsDialog",docgenInfo:DmsDialog.__docgenInfo,path:"src\\components\\dms-dialog.jsx"});var lib=__webpack_require__(177),lib_default=__webpack_require__.n(lib),emoji_selector_module=__webpack_require__(272),emoji_selector_module_default=__webpack_require__.n(emoji_selector_module);function emoji_selector_slicedToArray(arr,i){return function emoji_selector_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function emoji_selector_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function emoji_selector_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return emoji_selector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return emoji_selector_arrayLikeToArray(o,minLen)}(arr,i)||function emoji_selector_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function emoji_selector_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function EmojiSelector(props){var _useState2=emoji_selector_slicedToArray(Object(react.useState)(""),2),searchValue=_useState2[0],setSearchValue=_useState2[1],freeNames=["slightly_smiling_face","neutral_face","slightly_frowning_face","smile","laughing","angry","rage","laughing","stuck_out_tongue_winking_eye","kssing_heart","open_mouth","cry","wink","sunglasses","upside_down_face","vomiting","sleeping","heart","broken_heart","blush","wave","v","shushing","unamused","roll_eyes","hamburger","stop_sign","star"],previewNames=["fire","100","thinking","ok_hand","peach","eggplant","ghost","alien","robot"],freeCodes=freeNames.map((function(name){return lib_default.a.getUnicode(name)})),previewCodes=previewNames.map((function(name){return lib_default.a.getUnicode(name)}));return Object(jsx_runtime.jsxs)("div",{className:emoji_selector_module_default.a["emoji-selector"],children:[Object(jsx_runtime.jsx)("input",{onInput:function onInput(e){setSearchValue(e.target.value)},value:searchValue,autoFocus:!0,placeholder:"smile, angry, laughing, etc..."}),Object(jsx_runtime.jsx)("section",{children:(props.premium?lib_default.a.unicode:freeCodes).reduce((function(accumulator,emojiChar,i){return(""===searchValue||(props.premium?lib_default.a.names:freeNames)[i].includes(searchValue))&&accumulator.push(Object(jsx_runtime.jsx)("span",{title:(props.premium?lib_default.a.names:freeNames)[i],onClick:function onClick(){if(props.isAnonymous)return props.setErrors(["Create an account to do that."]);props.onSelect(emojiChar)},children:emojiChar},"emoji-"+i)),accumulator}),[])}),!props.premium&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("section",{className:emoji_selector_module_default.a.preview,children:previewCodes.reduce((function(accumulator,emojiChar,i){return(""===searchValue||previewNames[i].includes(searchValue))&&accumulator.push(Object(jsx_runtime.jsx)("span",{title:previewNames[i],onClick:function onClick(){props.setPremiumPromptOpen(!0)},children:emojiChar},"emoji-preview-"+i)),accumulator}),[])}),Object(jsx_runtime.jsxs)("footer",{children:["Want more emojis?"," ",Object(jsx_runtime.jsx)("button",{className:emoji_selector_module_default.a.link,onClick:function onClick(){props.setPremiumOpen(!0)},children:"Upgrade to Premium now!"})]})]})]})}function ErrorDialog(props){return props.errors.length>0&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["error-dialog"],children:[Object(jsx_runtime.jsxs)("header",{children:["Error:",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){props.requestClose()}})]}),Object(jsx_runtime.jsx)("main",{children:props.errors.map((function(error,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.error,children:error},i)}))}),Object(jsx_runtime.jsx)("footer",{})]})}EmojiSelector.displayName="EmojiSelector",EmojiSelector.__docgenInfo={description:"",methods:[],displayName:"EmojiSelector"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\emoji-selector.jsx"]={name:"EmojiSelector",docgenInfo:EmojiSelector.__docgenInfo,path:"src\\components\\emoji-selector.jsx"}),ErrorDialog.__docgenInfo={description:"",methods:[],displayName:"ErrorDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\error-dialog.jsx"]={name:"ErrorDialog",docgenInfo:ErrorDialog.__docgenInfo,path:"src\\components\\error-dialog.jsx"});__webpack_require__(347),__webpack_require__(974),__webpack_require__(274),__webpack_require__(32);function filtered_words_dialog_toConsumableArray(arr){return function filtered_words_dialog_arrayWithoutHoles(arr){if(Array.isArray(arr))return filtered_words_dialog_arrayLikeToArray(arr)}(arr)||function filtered_words_dialog_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||filtered_words_dialog_unsupportedIterableToArray(arr)||function filtered_words_dialog_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function filtered_words_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function filtered_words_dialog_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){filtered_words_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){filtered_words_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function filtered_words_dialog_slicedToArray(arr,i){return function filtered_words_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function filtered_words_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||filtered_words_dialog_unsupportedIterableToArray(arr,i)||function filtered_words_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function filtered_words_dialog_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return filtered_words_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?filtered_words_dialog_arrayLikeToArray(o,minLen):void 0}}function filtered_words_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function FilteredWordsDialog(props){var _useState2=filtered_words_dialog_slicedToArray(Object(react.useState)(""),2),word=_useState2[0],setWord=_useState2[1],_useState4=filtered_words_dialog_slicedToArray(Object(react.useState)([]),2),errors=_useState4[0],setErrors=_useState4[1],query=props.open?settingsRef.doc("filteredWords"):null,filteredWords=filtered_words_dialog_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.c)(query),1)[0],_useState6=filtered_words_dialog_slicedToArray(Object(react.useState)(1),2),page=_useState6[0],setPage=_useState6[1],start=10*(page-1),end=10*page;return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["filtered-words"],children:[Object(jsx_runtime.jsxs)("header",{children:["Filtered words",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setWord(""),setErrors([]),props.requestClose()}})]}),Object(jsx_runtime.jsxs)("main",{children:[filteredWords&&filteredWords.list.slice(start,end).map((function(word,i){return Object(jsx_runtime.jsxs)("div",{children:[word," ",Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:function(){var _ref=filtered_words_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee(e){var newWords;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:e.preventDefault(),(newWords=filtered_words_dialog_toConsumableArray(filteredWords.list)).splice(newWords.indexOf(word),1),settingsRef.doc("filteredWords").update({list:dist_index_esm.a.firestore.FieldValue.arrayRemove(word),regex:newWords.length?new RegExp(newWords.map((function(s){return s.replace(/[()[\]{}*+?^$|#.,\\\s-]/g,"\\$&")})).sort((function(a,b){return b.length-a.length})).join("|"),"gi").source:null});case 4:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),children:"remove"})]},i)})),Object(jsx_runtime.jsxs)("form",{onSubmit:function(){var _ref2=filtered_words_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){var list;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(e.preventDefault(),!(word.length<4)){_context2.next=4;break}return setErrors(["Word must be 4+ characters."]),_context2.abrupt("return");case 4:list=filteredWords?filteredWords.list:[],settingsRef.doc("filteredWords").set({list:dist_index_esm.a.firestore.FieldValue.arrayUnion(word),regex:new RegExp(filtered_words_dialog_toConsumableArray(new Set([].concat(filtered_words_dialog_toConsumableArray(list),[word]))).map((function(s){return s.replace(/[()[\]{}*+?^$|#.,\\\s-]/g,"\\$&")})).sort((function(a,b){return b.length-a.length})).join("|"),"gi").source},{merge:!0}),setErrors([]);case 7:case"end":return _context2.stop()}}),_callee2)})));return function(_x2){return _ref2.apply(this,arguments)}}(),children:[errors.map((function(error,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.error,children:error},i)})),Object(jsx_runtime.jsx)("input",{type:"text",placeholder:"word to filter",onInput:function onInput(e){setWord(e.target.value)},value:word})," ",Object(jsx_runtime.jsx)("button",{children:"Add"})]})]}),Object(jsx_runtime.jsx)("footer",{className:pagination_controls_module_default.a["pagination-controls"],children:filteredWords&&Object(jsx_runtime.jsx)(react_paginate_default.a,{pageCount:Math.ceil(filteredWords.length/10),pageRangeDisplayed:10,marginPagesDisplayed:2,onPageChange:function onPageChange(item){setPage(item.selected+1)},nextLabel:">",previousLabel:"<",disabledClassName:pagination_controls_module_default.a.disabled,activeClassName:pagination_controls_module_default.a.selected})})]})}FilteredWordsDialog.__docgenInfo={description:"",methods:[],displayName:"FilteredWordsDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\filtered-words-dialog.jsx"]={name:"FilteredWordsDialog",docgenInfo:FilteredWordsDialog.__docgenInfo,path:"src\\components\\filtered-words-dialog.jsx"});__webpack_require__(33);function menu_with_button_slicedToArray(arr,i){return function menu_with_button_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function menu_with_button_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function menu_with_button_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return menu_with_button_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return menu_with_button_arrayLikeToArray(o,minLen)}(arr,i)||function menu_with_button_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function menu_with_button_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function MenuWithButton(props){var _useState2=menu_with_button_slicedToArray(Object(react.useState)(!1),2),isMenuOpen=_useState2[0],setMenuOpen=_useState2[1],_useState4=menu_with_button_slicedToArray(Object(react.useState)(!1),2),keepOpen=_useState4[0],setKeepOpen=_useState4[1];return Object(react.useEffect)((function(){keepOpen?(setKeepOpen(!1),setMenuOpen(!0)):setMenuOpen(!1)}),[props.openKey]),Object(jsx_runtime.jsxs)("span",{style:{position:"relative"},children:[Object(jsx_runtime.jsx)("span",{className:chat_room_module_default.a.pointer,onClickCapture:function onClickCapture(){isMenuOpen||setKeepOpen(!0)},children:props.button}),isMenuOpen&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.menu,onClickCapture:function onClickCapture(e){props.keepOpen&&setKeepOpen(!0)},children:[props.items&&Object.keys(props.items).map((function(key,i){return Object(jsx_runtime.jsx)("div",{onClickCapture:function onClickCapture(){props.items[key]()},children:key},i)})),props.children]})]})}MenuWithButton.displayName="MenuWithButton",MenuWithButton.__docgenInfo={description:"",methods:[],displayName:"MenuWithButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\menu-with-button.jsx"]={name:"MenuWithButton",docgenInfo:MenuWithButton.__docgenInfo,path:"src\\components\\menu-with-button.jsx"});__webpack_require__(351);var CameraAlt=__webpack_require__(562),CameraAlt_default=__webpack_require__.n(CameraAlt),SentimentVerySatisfied=__webpack_require__(563),SentimentVerySatisfied_default=__webpack_require__.n(SentimentVerySatisfied),TextFormat=__webpack_require__(564),TextFormat_default=__webpack_require__.n(TextFormat);__webpack_require__(492);function hexToRgb(hex){var bigint=parseInt(hex.substring(1),16);return(bigint>>16&255)+","+(bigint>>8&255)+","+(255&bigint)}function storage_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function storage_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){storage_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){storage_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function uploadFile(_x){return _uploadFile.apply(this,arguments)}function _uploadFile(){return(_uploadFile=storage_asyncToGenerator(regeneratorRuntime.mark((function _callee(file){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",new Promise((function(resolve,reject){var uploadFileFunction=dist_index_esm.a.functions().httpsCallable("uploadFile"),reader=new FileReader;reader.addEventListener("load",(function(){uploadFileFunction({base64FileString:reader.result,extension:file.name.split(".").pop()}).then((function(result){resolve(result.data.url)})).catch((function(error){reject(error)}))}),!1),reader.readAsDataURL(file)})));case 1:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}function message_input_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function message_input_form_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){message_input_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){message_input_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function message_input_form_slicedToArray(arr,i){return function message_input_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function message_input_form_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function message_input_form_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return message_input_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return message_input_form_arrayLikeToArray(o,minLen)}(arr,i)||function message_input_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function message_input_form_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function MessageInputForm(props){var _useState2=message_input_form_slicedToArray(Object(react.useState)(!1),2),loading=_useState2[0],setLoading=_useState2[1],fontSize=!props.premium&&props.fontSize>=15?15:props.fontSize;return Object(jsx_runtime.jsxs)("form",{className:chat_room_module_default.a["message-form"],onSubmit:props.sendMessage,children:[Object(jsx_runtime.jsxs)("label",{className:loading?"":chat_room_module_default.a.pointer,children:[Object(jsx_runtime.jsx)("div",{className:loading?chat_room_module_default.a["loading-placeholder"]:"",children:Object(jsx_runtime.jsx)(CameraAlt_default.a,{className:chat_room_module_default.a["camera-icon"]+" "})}),Object(jsx_runtime.jsx)("input",{type:"file",onChange:function onChange(e){loading||(setLoading(!0),timeout(5e3,message_input_form_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var file,url;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(e.target.files.length){_context.next=2;break}return _context.abrupt("return");case 2:return file=e.target.files[0],_context.next=5,uploadFile(file);case 5:if(url=_context.sent){_context.next=8;break}throw new Error("Error uploading file.");case 8:e.target.form.message.focus(),props.setMessageValue(props.messageValue+" "+url+" ");case 10:case"end":return _context.stop()}}),_callee)})))).catch((function(error){props.setErrors([translateError(error).message])})).finally((function(){setLoading(!1),e.target.value=""})))}})]}),Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a["input-wrapper"],style:props.stylesEnabled&&props.premium?{backgroundColor:"rgba("+hexToRgb(props.msgBgColor)+","+props.msgBgTransparency+")"}:{backgroundColor:"white"},children:[Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["message-background-image"],style:props.stylesEnabled&&props.premium?{backgroundImage:"url("+props.msgBgImg+")",backgroundRepeat:props.msgBgRepeat,backgroundPosition:props.msgBgPosition,opacity:props.msgBgImgTransparency}:{}}),Object(jsx_runtime.jsx)("textarea",{name:"message",ref:function ref(input){props.setMessageInput(input)},autoFocus:!0,value:props.messageValue,onChange:function onChange(e){return props.setMessageValue(e.target.value)},placeholder:"Type here to send a message",onKeyDown:function onKeyDown(e){if("b"!==e.key&&"B"!==e.key||!e.ctrlKey){if(("i"===e.key||"I"===e.key)&&e.ctrlKey){var _result=props.toggleSelectionMarkup(MARKUP_SYMBOLS.ITALICS);props.setMessageValue(_result.value),props.setSelection({start:_result.start,end:_result.end})}}else{var result=props.toggleSelectionMarkup(MARKUP_SYMBOLS.BOLD);props.setMessageValue(result.value),props.setSelection({start:result.start,end:result.end})}},onKeyPress:function onKeyPress(e){"Enter"!==e.key||e.shiftKey||(e.target.form.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0})),e.preventDefault())},style:props.stylesEnabled?{fontFamily:props.font.style,fontSize:fontSize,color:props.fontColor}:{}})]}),Object(jsx_runtime.jsx)(SentimentVerySatisfied_default.a,{className:chat_room_module_default.a.pointer+" "+(props.isEmojisOpen?chat_room_module_default.a.outlined:""),onClick:function onClick(e){props.setEmojisOpen(!props.isEmojisOpen)}}),Object(jsx_runtime.jsx)(TextFormat_default.a,{className:chat_room_module_default.a.pointer+" "+(props.isFormatOpen?chat_room_module_default.a.outlined:""),onClick:function onClick(e){props.setFormatOpen(!props.isFormatOpen)}})]})}MessageInputForm.displayName="MessageInputForm",MessageInputForm.__docgenInfo={description:"",methods:[],displayName:"MessageInputForm"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\message-input-form.jsx"]={name:"MessageInputForm",docgenInfo:MessageInputForm.__docgenInfo,path:"src\\components\\message-input-form.jsx"});var Block=__webpack_require__(568),Block_default=__webpack_require__.n(Block),Person=__webpack_require__(270),Person_default=__webpack_require__.n(Person),is_image_url=__webpack_require__(565),is_image_url_default=__webpack_require__.n(is_image_url),react_markdown=__webpack_require__(566),react_markdown_default=__webpack_require__.n(react_markdown),remark_gfm=__webpack_require__(567),remark_gfm_default=__webpack_require__.n(remark_gfm);__webpack_require__(1113);function chat_message_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function chat_message_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){chat_message_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){chat_message_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function chat_message_slicedToArray(arr,i){return function chat_message_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function chat_message_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function chat_message_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return chat_message_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return chat_message_arrayLikeToArray(o,minLen)}(arr,i)||function chat_message_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function chat_message_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Link(props){var _useState2=chat_message_slicedToArray(Object(react.useState)(props.href),2),children=_useState2[0],setChildren=_useState2[1],_useState4=chat_message_slicedToArray(Object(react.useState)(""),2),providerName=_useState4[0],setProviderName=_useState4[1],_useState6=chat_message_slicedToArray(Object(react.useState)(!1),2),isInline=_useState6[0],setInline=_useState6[1];return Object(react.useEffect)((function(){dist_index_esm.a.functions().httpsCallable("getOembed")({url:props.href}).then((function(result){result.data.html?(setProviderName(result.data.providerName),setChildren(Object(jsx_runtime.jsx)("span",{dangerouslySetInnerHTML:{__html:result.data.html}}))):is_image_url_default()(props.href)?(setInline(!0),setChildren(Object(jsx_runtime.jsx)("a",{href:props.href,target:"_blank",rel:"nofollow noreferrer noopener",onMouseUp:function onMouseUp(e){e.stopPropagation()},style:{padding:"0px",display:"inline-flex",verticalAlign:"bottom"},children:Object(jsx_runtime.jsx)("img",{src:props.href,alt:"embedded"})}))):setChildren(Object(jsx_runtime.jsx)("a",{href:props.href,target:"_blank",rel:"nofollow noreferrer noopener",onMouseUp:function onMouseUp(e){e.stopPropagation()},children:props.href}))}))}),[props.href]),Object(jsx_runtime.jsx)("span",{onMouseUp:function onMouseUp(e){e.stopPropagation()},"data-provider":providerName,style:isInline?{display:"inline"}:{},children:children})}function ChatMessage(props){var _props$message=props.message,text=_props$message.text,uid=_props$message.uid,key=_props$message.key,premium=_props$message.premium,photoUrl=_props$message.photoUrl,createdAt=_props$message.createdAt,username=_props$message.username,fontSize=_props$message.fontSize,fontColor=_props$message.fontColor,font=_props$message.font,backgroundImage=_props$message.backgroundImage,nameColor=_props$message.nameColor,bgColor=_props$message.bgColor,bgTransparency=_props$message.bgTransparency,msgBgRepeat=_props$message.msgBgRepeat,msgBgPosition=_props$message.msgBgPosition,msgBgImgTransparency=_props$message.msgBgImgTransparency;fontSize=!premium&&fontSize>=15?15:fontSize;var currentUser=props.currentUser,stylesEnabled=props.stylesEnabled,messagesRef=props.messagesRef,messageClass=uid===auth.currentUser.uid?"sent":"received",mouseDownSpot=null,doesMentionCurrentUser=new RegExp("@"+username+"\\b","g").test(text);return text=text.replace(new RegExp("@"+username+"\\b","g"),"**@"+username+"**"),Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.message+" "+chat_room_module_default.a[messageClass]+" "+(doesMentionCurrentUser?chat_room_module_default.a.mention:""),onMouseDown:function onMouseDown(e){mouseDownSpot={x:e.pageX,y:e.pageY}},onMouseUp:function onMouseUp(e){if(0===e.button&&mouseDownSpot){var a=mouseDownSpot.x-e.pageX,b=mouseDownSpot.y-e.pageY;Math.sqrt(a*a+b*b)<=2&&(props.onClick(username),mouseDownSpot=null)}},style:stylesEnabled&&premium?{backgroundColor:"rgba("+hexToRgb(bgColor)+","+bgTransparency+")"}:{},children:[Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["mention-highlight"]}),Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["message-background-image"],style:stylesEnabled&&premium?{backgroundImage:"url("+backgroundImage+")",backgroundRepeat:msgBgRepeat,backgroundPosition:msgBgPosition,opacity:msgBgImgTransparency}:{}}),photoUrl?Object(jsx_runtime.jsx)("img",{className:chat_room_module_default.a.avatar,src:photoUrl,alt:"profile"}):Object(jsx_runtime.jsx)(Person_default.a,{className:chat_room_module_default.a.avatar}),Object(jsx_runtime.jsxs)("span",{className:chat_room_module_default.a["message-details"],children:[Object(jsx_runtime.jsx)("span",{className:chat_room_module_default.a["message-timestamp"],children:createdAt&&createdAt.toDate().toLocaleString()}),currentUser.isModerator&&Object(jsx_runtime.jsx)("button",{onClick:function onClick(){timeout(5e3,chat_message_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,banUser(username);case 2:result=_context.sent,props.setAlerts([result.data.message]);case 4:case"end":return _context.stop()}}),_callee)})))).catch((function(error){props.setErrors([translateError(error).message])}))},onMouseUp:function onMouseUp(e){e.stopPropagation()},children:Object(jsx_runtime.jsx)(Block_default.a,{})}),currentUser.isModerator&&Object(jsx_runtime.jsx)("button",{onClick:function deleteMessage(){messagesRef.doc(props.message.id).update({isDeleted:!0})},onMouseUp:function onMouseUp(e){e.stopPropagation()},children:"X"})]}),Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsxs)("span",{className:chat_room_module_default.a["message-contents"],style:stylesEnabled?{fontSize:fontSize+"px",color:fontColor,fontFamily:font.style}:{},children:[Object(jsx_runtime.jsxs)("span",{className:chat_room_module_default.a["message-username"],style:stylesEnabled?{color:nameColor}:{},children:[username,":"," "]}),Object(react.useMemo)((function(){return Object(jsx_runtime.jsx)(react_markdown_default.a,{components:{a:function a(props){return Object(jsx_runtime.jsx)(Link,{shouldComponentUpdate:!1,href:props.href})}},plugins:[remark_gfm_default.a],allowedElements:["p","em","strong","u","a"],children:text})}),[text])]})})]},key)}function message_list_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function message_list_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){message_list_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){message_list_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function message_list_slicedToArray(arr,i){return function message_list_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function message_list_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function message_list_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return message_list_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return message_list_arrayLikeToArray(o,minLen)}(arr,i)||function message_list_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function message_list_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function MessageList(props){var setErrors=props.setErrors,setAlerts=props.setAlerts,messagesRef=props.messagesRef,defaultMessages=props.defaultMessages,stylesEnabled=props.stylesEnabled,onMessageClick=props.onMessageClick,currentUser=props.currentUser,sentMsgCount=props.sentMsgCount,messageList=Object(react.useRef)(),_useState2=message_list_slicedToArray(Object(react.useState)([]),2),messages=_useState2[0],setMessages=_useState2[1],_useState4=message_list_slicedToArray(Object(react.useState)(!1),2),paused=_useState4[0],setPaused=_useState4[1];return Object(react.useEffect)((function(){paused||setMessages(defaultMessages||[])}),[defaultMessages,paused]),Object(react.useEffect)((function(){messageList.current.scrollTop=0}),[sentMsgCount]),Object(jsx_runtime.jsxs)("section",{ref:messageList,className:chat_room_module_default.a["messages-section"],children:[Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["pagination-controls"],children:messages.length&&defaultMessages&&messages[0].id!==defaultMessages[0].id&&Object(jsx_runtime.jsx)("button",{onClick:function onClick(){setPaused(!1)},children:"Jump to present"})}),messages&&messages.map((function(msg){return Object(jsx_runtime.jsx)(ChatMessage,{setErrors:setErrors,setAlerts:setAlerts,message:msg,stylesEnabled:stylesEnabled,onClick:onMessageClick,currentUser:currentUser,messagesRef:messagesRef},msg.id)})),Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a["pagination-controls"],children:[messages.length>=25&&Object(jsx_runtime.jsx)("button",{onClick:message_list_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var query,snapshot,newMessages;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setPaused(!0),query=messagesRef.where("isDeleted","==",!1).orderBy("createdAt","desc").startAfter(messages[messages.length-1].createdAt).limit(25),_context.next=4,query.get();case 4:snapshot=_context.sent,newMessages=snapshot.docs.map((function(doc){return Object.assign({id:doc.id},doc.data())})),setMessages(newMessages);case 7:case"end":return _context.stop()}}),_callee)}))),children:"Older"}),messages.length&&defaultMessages&&messages[0].id!==defaultMessages[0].id&&Object(jsx_runtime.jsx)("button",{onClick:message_list_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var query,snapshot,newMessages;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return setPaused(!0),query=messagesRef.where("isDeleted","==",!1).orderBy("createdAt","desc").endBefore(messages[0].createdAt).limitToLast(25),_context2.next=4,query.get();case 4:snapshot=_context2.sent,(newMessages=snapshot.docs.map((function(doc){return Object.assign({id:doc.id},doc.data())})))[0].id===defaultMessages[0].id?setPaused(!1):newMessages.length&&setMessages(newMessages);case 7:case"end":return _context2.stop()}}),_callee2)}))),children:"Newer"})]})]})}function mod_action_log_dialog_slicedToArray(arr,i){return function mod_action_log_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function mod_action_log_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function mod_action_log_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return mod_action_log_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mod_action_log_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function mod_action_log_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mod_action_log_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ModActionLogDialog(props){var query=props.open?modActionLogRef.orderBy("date","desc"):null,modActions=mod_action_log_dialog_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.a)(query,{idField:"id"}),1)[0],_useState2=mod_action_log_dialog_slicedToArray(Object(react.useState)(1),2),page=_useState2[0],setPage=_useState2[1],start=5*(page-1),end=5*page;return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["mod-action-log"],children:[Object(jsx_runtime.jsxs)("header",{children:["Mod Action Log",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){props.requestClose()}})]}),Object(jsx_runtime.jsx)("main",{children:modActions&&Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:modActions.slice(start,end).map((function(action,i){return Object(jsx_runtime.jsxs)("div",{children:[action.action,Object(jsx_runtime.jsx)("small",{children:action.date.toDate().toLocaleString()})]},i)}))})}),Object(jsx_runtime.jsx)("footer",{className:pagination_controls_module_default.a["pagination-controls"],children:modActions&&Object(jsx_runtime.jsx)(react_paginate_default.a,{pageCount:Math.ceil(modActions.length/5),pageRangeDisplayed:5,marginPagesDisplayed:2,onPageChange:function onPageChange(item){setPage(item.selected+1)},nextLabel:">",previousLabel:"<",disabledClassName:pagination_controls_module_default.a.disabled,activeClassName:pagination_controls_module_default.a.selected})})]})}function moderators_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function moderators_dialog_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){moderators_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){moderators_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function moderators_dialog_slicedToArray(arr,i){return function moderators_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function moderators_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function moderators_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return moderators_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return moderators_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function moderators_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function moderators_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ModeratorsDialog(props){var _useState2=moderators_dialog_slicedToArray(Object(react.useState)(""),2),username=_useState2[0],setUsername=_useState2[1],_useState4=moderators_dialog_slicedToArray(Object(react.useState)([]),2),errors=_useState4[0],setErrors=_useState4[1],addModerator=dist_index_esm.a.functions().httpsCallable("addModerator"),removeModerator=dist_index_esm.a.functions().httpsCallable("removeModerator"),query=props.open?usersRef.orderBy("lowercaseUsername").where("isModerator","==",!0):null,mods=moderators_dialog_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.a)(query,{idField:"id"}),1)[0],_useState6=moderators_dialog_slicedToArray(Object(react.useState)(1),2),page=_useState6[0],setPage=_useState6[1],start=10*(page-1),end=10*page;return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a.moderators,children:[Object(jsx_runtime.jsxs)("header",{children:["Moderators",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setUsername(""),setErrors([]),props.requestClose()}})]}),Object(jsx_runtime.jsxs)("main",{children:[mods&&mods.slice(start,end).map((function(mod,i){return Object(jsx_runtime.jsxs)("div",{children:[mod.username," ",Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:moderators_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,removeModerator(mod.username);case 2:(result=_context.sent).error?setErrors([result.error]):setErrors([]);case 4:case"end":return _context.stop()}}),_callee)}))),children:"remove"})]},i)})),Object(jsx_runtime.jsxs)("form",{onSubmit:function(){var _ref2=moderators_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){var result;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return e.preventDefault(),_context2.next=3,addModerator(username);case 3:(result=_context2.sent).data.error?setErrors([result.data.error]):setErrors([]);case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),children:[errors.map((function(error,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.error,children:error},i)})),Object(jsx_runtime.jsx)("input",{type:"text",placeholder:"Username",onInput:function onInput(e){setUsername(e.target.value)},value:username})," ",Object(jsx_runtime.jsx)("button",{children:"Add"})]}),Object(jsx_runtime.jsx)("footer",{className:pagination_controls_module_default.a["pagination-controls"],children:mods&&Object(jsx_runtime.jsx)(react_paginate_default.a,{pageCount:Math.ceil(mods.length/10),pageRangeDisplayed:10,marginPagesDisplayed:2,onPageChange:function onPageChange(item){setPage(item.selected+1)},nextLabel:">",previousLabel:"<",disabledClassName:pagination_controls_module_default.a.disabled,activeClassName:pagination_controls_module_default.a.selected})})]})]})}Link.displayName="Link",ChatMessage.displayName="ChatMessage",ChatMessage.__docgenInfo={description:"",methods:[],displayName:"ChatMessage"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\chat-message.jsx"]={name:"ChatMessage",docgenInfo:ChatMessage.__docgenInfo,path:"src\\components\\chat-message.jsx"}),MessageList.displayName="MessageList",MessageList.__docgenInfo={description:"",methods:[],displayName:"MessageList"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\message-list.jsx"]={name:"MessageList",docgenInfo:MessageList.__docgenInfo,path:"src\\components\\message-list.jsx"}),ModActionLogDialog.__docgenInfo={description:"",methods:[],displayName:"ModActionLogDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\mod-action-log-dialog.jsx"]={name:"ModActionLogDialog",docgenInfo:ModActionLogDialog.__docgenInfo,path:"src\\components\\mod-action-log-dialog.jsx"}),ModeratorsDialog.__docgenInfo={description:"",methods:[],displayName:"ModeratorsDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\moderators-dialog.jsx"]={name:"ModeratorsDialog",docgenInfo:ModeratorsDialog.__docgenInfo,path:"src\\components\\moderators-dialog.jsx"});var stripe_esm=__webpack_require__(569);function stripe_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function stripe_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){stripe_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){stripe_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _sendToStripe(){return _sendToStripe=stripe_asyncToGenerator(regeneratorRuntime.mark((function _callee2(uid,priceId){var returnUrl;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return(returnUrl=new URL(window.location)).searchParams.set("chat-logout","1"),_context2.abrupt("return",firestore.collection("users").doc(uid).collection("checkout_sessions").add({price:priceId,success_url:returnUrl.href,cancel_url:window.location.href}).then((function(docRef){docRef.onSnapshot(function(){var _ref=stripe_asyncToGenerator(regeneratorRuntime.mark((function _callee(snap){var _snap$data,error,sessionId,stripe;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(_snap$data=snap.data(),error=_snap$data.error,sessionId=_snap$data.sessionId,error&&console.error("An error occurred: "+error.message),!sessionId){_context.next=9;break}return console.log("redirecting"),_context.next=6,Object(stripe_esm.a)("pk_live_51JXmQzAknxYOkdXtsqc2wu0rOBZGx6oB3sKa5SKZLc2B2ATVQrpzPIpUl7PkyJqjLygyFtX5vgnBEA2dvtI4xn8m00DGBcifrW");case 6:return stripe=_context.sent,_context.next=9,stripe.redirectToCheckout({sessionId:sessionId});case 9:case"end":return _context.stop()}}),_callee)})));return function(_x3){return _ref.apply(this,arguments)}}())})));case 3:case"end":return _context2.stop()}}),_callee2)}))),_sendToStripe.apply(this,arguments)}function _sendToCustomerPortal(){return(_sendToCustomerPortal=stripe_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var functionRef,_yield$functionRef,data;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return functionRef=dist_index_esm.a.functions().httpsCallable("ext-firestore-stripe-subscriptions-createPortalLink"),_context3.next=3,functionRef({returnUrl:window.location.origin});case 3:_yield$functionRef=_context3.sent,data=_yield$functionRef.data,window.location.assign(data.url);case 6:case"end":return _context3.stop()}}),_callee3)})))).apply(this,arguments)}function premium_dialog_slicedToArray(arr,i){return function premium_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function premium_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function premium_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return premium_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return premium_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function premium_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function premium_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function PremiumDialog(props){var isAnonymous=props.isAnonymous,uid=props.uid,_useState2=premium_dialog_slicedToArray(Object(react.useState)(3),2),period=_useState2[0],setPeriod=_useState2[1],_useState4=premium_dialog_slicedToArray(Object(react.useState)(!1),2),loading=_useState4[0],setLoading=_useState4[1],query=firestore.collection("users").doc(uid).collection("subscriptions").where("status","==","active").where("role","==","premium"),subscriptions=premium_dialog_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.a)(query),1)[0];return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["premium-dialog"],children:[Object(jsx_runtime.jsxs)("header",{children:["Premium",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){props.requestClose()}})]}),Object(jsx_runtime.jsx)("main",{children:subscriptions&&subscriptions.length?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[subscriptions.map((function(subscription,i){var expiration=new Date(Date.UTC(1970,0,1));expiration.setUTCSeconds(subscription.current_period_end.seconds);var formatter=new Intl.DateTimeFormat(void 0,{timeStyle:"short",dateStyle:"short"});return Object(jsx_runtime.jsxs)("span",{children:["Your subscription expires ",formatter.format(expiration)]},i)})),Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)("button",{className:loading?chat_room_module_default.a.loading:"",onClick:function onClick(e){e.preventDefault(),loading||(setLoading(!0),timeout(5e3,(function(){return function sendToCustomerPortal(){return _sendToCustomerPortal.apply(this,arguments)}().then((function(){setTimeout((function(){setLoading(!1)}),2e3)}))})))},children:"Manage Subscription"})})]}):isAnonymous?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Must create an account to upgrade to Premium."}):Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Upgrade to a Premium account for perks like more emojis, more message style options, and more...",Object(jsx_runtime.jsxs)("form",{onSubmit:function onSubmit(e){e.preventDefault(),loading||(setLoading(!0),timeout(5e3,(function(){(function sendToStripe(_x,_x2){return _sendToStripe.apply(this,arguments)})(uid,e.target.period.value).then((function(){setTimeout((function(){setLoading(!1)}),2e3)}))})))},children:[Object(jsx_runtime.jsxs)("label",{children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:"period",value:"price_1JYOR4AknxYOkdXtABxRsfSe",onChange:function onChange(){return setPeriod(3)},defaultChecked:!0})," ","3 Months - $2/month"]}),Object(jsx_runtime.jsxs)("label",{children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:"period",value:"price_1JYOR4AknxYOkdXt5t43to85",onChange:function onChange(){return setPeriod(6)}})," ","6 Months - $1.5/month"]}),Object(jsx_runtime.jsxs)("label",{children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:"period",value:"price_1JYOR4AknxYOkdXtK8A9QqWk",onChange:function onChange(){return setPeriod(12)}})," ","12 Months - $1/month"]}),"Billed every ",period," months. Cancel any time.",Object(jsx_runtime.jsx)("label",{children:Object(jsx_runtime.jsx)("button",{className:loading?chat_room_module_default.a.loading:"",children:"Subscribe"})})]})]})}),Object(jsx_runtime.jsx)("footer",{})]})}PremiumDialog.__docgenInfo={description:"",methods:[],displayName:"PremiumDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\premium-dialog.jsx"]={name:"PremiumDialog",docgenInfo:PremiumDialog.__docgenInfo,path:"src\\components\\premium-dialog.jsx"});var Create=__webpack_require__(570),Create_default=__webpack_require__.n(Create);function profile_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function profile_dialog_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){profile_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){profile_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function profile_dialog_slicedToArray(arr,i){return function profile_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function profile_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function profile_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return profile_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return profile_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function profile_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function profile_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ProfileDialog(props){var open=props.open,requestClose=props.requestClose,setErrors=props.setErrors,setAlerts=props.setAlerts,photoUrl=props.photoUrl,setPhotoUrl=props.setPhotoUrl,isVerified=props.isVerified,_useState2=profile_dialog_slicedToArray(Object(react.useState)(!1),2),loadingImg=_useState2[0],setLoadingImg=_useState2[1],_useState4=profile_dialog_slicedToArray(Object(react.useState)(!1),2),loadingEmail=_useState4[0],setLoadingEmail=_useState4[1];return open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["profile-editor"],children:[Object(jsx_runtime.jsxs)("header",{children:["Edit profile",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){requestClose()}})]}),Object(jsx_runtime.jsxs)("div",{children:[Object(jsx_runtime.jsxs)("label",{className:loadingImg?chat_room_module_default.a.loading:"",children:[photoUrl?Object(jsx_runtime.jsx)("img",{className:chat_room_module_default.a.avatar,src:photoUrl,alt:"profile"}):Object(jsx_runtime.jsx)(Person_default.a,{className:chat_room_module_default.a.avatar}),!loadingImg&&Object(jsx_runtime.jsx)(Create_default.a,{}),Object(jsx_runtime.jsx)("input",{type:"file",onChange:function onChange(e){loadingImg||e.target.files.length&&(setLoadingImg(!0),timeout(5e3,profile_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var file,url;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return file=e.target.files[0],_context.next=3,uploadFile(file);case 3:if(url=_context.sent){_context.next=6;break}throw new Error("Error uploading file.");case 6:return _context.next=8,auth.currentUser.updateProfile({photoURL:url});case 8:setPhotoUrl(url);case 9:case"end":return _context.stop()}}),_callee)})))).catch((function(error){setErrors([error.message])})).finally((function(){setLoadingImg(!1)})))}})]}),!isVerified&&Object(jsx_runtime.jsx)("button",{className:loadingEmail?chat_room_module_default.a.loading:"",onClick:function onClick(e){e.preventDefault(),loadingEmail||(setLoadingEmail(!0),timeout(5e3,profile_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var resendVerificationEmail,result;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return resendVerificationEmail=dist_index_esm.a.app().functions().httpsCallable("resendVerificationEmail"),_context2.next=3,resendVerificationEmail({returnUrl:window.location.href});case 3:if(!(result=_context2.sent).data.error){_context2.next=8;break}throw result.data.error;case 8:setAlerts([result.data.message]);case 9:case"end":return _context2.stop()}}),_callee2)})))).catch((function(error){setErrors([translateError(error).message])})).finally((function(){setLoadingEmail(!1)})))},children:"Resend Verification Email"})]})]})}function color_input_slicedToArray(arr,i){return function color_input_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function color_input_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function color_input_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return color_input_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return color_input_arrayLikeToArray(o,minLen)}(arr,i)||function color_input_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function color_input_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ColorInput(props){var _useState2=color_input_slicedToArray(Object(react.useState)(null),2),completeTimeout=_useState2[0],setCompleteTimeout=_useState2[1],_useState4=color_input_slicedToArray(Object(react.useState)(null),2),delayTimeout=_useState4[0],setDelayTimeout=_useState4[1];return Object(jsx_runtime.jsx)("input",{type:"color",onChange:function onChange(e){null===delayTimeout&&setDelayTimeout(setTimeout((function(){clearTimeout(completeTimeout),setCompleteTimeout(setTimeout((function(){props.onChangeComplete(e)}),500)),props.onChange(e),setDelayTimeout(null)}),200))},onClick:props.onClick,onClickCapture:props.onClickCapture,defaultValue:props.defaultValue,disabled:props.disabled})}function slider_input_slicedToArray(arr,i){return function slider_input_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function slider_input_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function slider_input_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return slider_input_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return slider_input_arrayLikeToArray(o,minLen)}(arr,i)||function slider_input_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function slider_input_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SliderInput(props){var _useState2=slider_input_slicedToArray(Object(react.useState)(null),2),completeTimeout=_useState2[0],setCompleteTimeout=_useState2[1],_useState4=slider_input_slicedToArray(Object(react.useState)(null),2),delayTimeout=_useState4[0],setDelayTimeout=_useState4[1];return Object(jsx_runtime.jsx)("input",{type:"range",min:props.min,max:props.max,defaultValue:props.defaultValue,className:chat_room_module_default.a.slider,onChange:function onChange(e){null===delayTimeout&&setDelayTimeout(setTimeout((function(){clearTimeout(completeTimeout),setCompleteTimeout(setTimeout((function(){props.onChangeComplete(e)}),500)),props.onChange(e),setDelayTimeout(null)}),200))},disabled:props.disabled})}function style_editor_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function style_editor_dialog_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){style_editor_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){style_editor_dialog_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function style_editor_dialog_slicedToArray(arr,i){return function style_editor_dialog_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function style_editor_dialog_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function style_editor_dialog_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return style_editor_dialog_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return style_editor_dialog_arrayLikeToArray(o,minLen)}(arr,i)||function style_editor_dialog_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function style_editor_dialog_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function StyleEditorDialog(props){var user=props.user,premium=props.premium,requestClose=props.requestClose,setPremiumPromptOpen=props.setPremiumPromptOpen,messagesRef=props.messagesRef,fontSize=props.fontSize,fontColor=props.fontColor,font=props.font,msgBgImg=props.msgBgImg,nameColor=props.nameColor,msgBgColor=props.msgBgColor,msgBgTransparency=props.msgBgTransparency,msgBgRepeat=props.msgBgRepeat,msgBgPosition=props.msgBgPosition,msgBgImgTransparency=props.msgBgImgTransparency,stylesEnabled=props.stylesEnabled,setNameColor=props.setNameColor,setMsgBgColor=props.setMsgBgColor,setMsgBgTransparency=props.setMsgBgTransparency,setMsgBgImg=props.setMsgBgImg,setMsgBgRepeat=props.setMsgBgRepeat,setMsgBgPosition=props.setMsgBgPosition,setMsgBgImgTransparency=props.setMsgBgImgTransparency,_useState2=style_editor_dialog_slicedToArray(Object(react.useState)(!1),2),loading=_useState2[0],setLoading=_useState2[1];return props.open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+chat_room_module_default.a["message-style-editor"],children:[Object(jsx_runtime.jsxs)("header",{children:["Message style editor",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){requestClose()}})]}),Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["sample-message-wrapper"],children:Object(jsx_runtime.jsx)(ChatMessage,{message:{text:"Sample message text",uid:user.uid,createdAt:new dist_index_esm.a.firestore.Timestamp(1726757369,337e6),username:user.username,fontSize:fontSize,fontColor:fontColor,font:font,backgroundImage:msgBgImg,nameColor:nameColor,bgColor:msgBgColor,bgTransparency:msgBgTransparency,msgBgRepeat:msgBgRepeat,msgBgPosition:msgBgPosition,msgBgImgTransparency:msgBgImgTransparency},stylesEnabled:stylesEnabled,onClick:function onClick(){},currentUser:user,messagesRef:messagesRef})}),Object(jsx_runtime.jsxs)("label",{children:["Name color",Object(jsx_runtime.jsx)(ColorInput,{defaultValue:nameColor,onChange:function onChange(e){setNameColor(e.target.value)},onChangeComplete:function onChangeComplete(e){usersRef.doc(user.uid).update({nameColor:e.target.value})}})]}),Object(jsx_runtime.jsxs)("label",{onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:["Bg color",Object(jsx_runtime.jsx)(ColorInput,{defaultValue:msgBgColor,onChange:function onChange(e){setMsgBgColor(e.target.value)},onChangeComplete:function onChangeComplete(e){usersRef.doc(user.uid).update({msgBgColor:e.target.value})},disabled:!premium})]}),Object(jsx_runtime.jsxs)("label",{onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:["Bg transparency",Object(jsx_runtime.jsx)(SliderInput,{min:"0",max:"100",defaultValue:100*msgBgTransparency,onChange:function onChange(e){setMsgBgTransparency(e.target.value/100)},onChangeComplete:function onChangeComplete(e){usersRef.doc(user.uid).update({msgBgTransparency:e.target.value/100})},disabled:!premium})]}),Object(jsx_runtime.jsx)("label",{children:Object(jsx_runtime.jsxs)("label",{className:chat_room_module_default.a.button+" "+(premium?"":chat_room_module_default.a.disabled)+" "+(loading?chat_room_module_default.a.loading:""),onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:["Upload Image",Object(jsx_runtime.jsx)("input",{type:"file",onChange:function onChange(e){loading||(setLoading(!0),timeout(5e3,style_editor_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var file,url;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(e.target.files.length){_context.next=2;break}return _context.abrupt("return");case 2:return file=e.target.files[0],_context.next=5,uploadFile(file);case 5:if(url=_context.sent){_context.next=8;break}throw new Error("Error uploading file.");case 8:return _context.next=10,usersRef.doc(user.uid).update({msgBgImg:url});case 10:setMsgBgImg(url);case 11:case"end":return _context.stop()}}),_callee)})))).catch((function(error){props.setErrors([error.message])})).finally((function(){setLoading(!1)})))},disabled:!premium})]})}),msgBgImg&&Object(jsx_runtime.jsx)("label",{onClick:function(){var _ref2=style_editor_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee2(e){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(premium){_context2.next=2;break}return _context2.abrupt("return",setPremiumPromptOpen(!0));case 2:return _context2.next=4,usersRef.doc(user.uid).update({msgBgImg:""});case 4:setMsgBgImg("");case 5:case"end":return _context2.stop()}}),_callee2)})));return function(_x){return _ref2.apply(this,arguments)}}(),className:chat_room_module_default.a.button+" "+(premium?"":chat_room_module_default.a.disabled),children:"Clear Image"}),Object(jsx_runtime.jsx)("div",{children:msgBgImg&&Object(jsx_runtime.jsxs)("label",{onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:[Object(jsx_runtime.jsx)("input",{type:"checkbox",onChange:function(){var _ref3=style_editor_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee3(e){var checked;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return checked=e.target.checked,_context3.next=3,usersRef.doc(user.uid).update({msgBgRepeat:checked?"repeat":"no-repeat"});case 3:setMsgBgRepeat(checked?"repeat":"no-repeat");case 4:case"end":return _context3.stop()}}),_callee3)})));return function(_x2){return _ref3.apply(this,arguments)}}(),defaultChecked:"repeat"===msgBgRepeat,disabled:!premium}),"Tile image"]})}),msgBgImg&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsxs)("div",{children:["Align image",Object(jsx_runtime.jsxs)("label",{onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:"msgBgPosition",defaultChecked:"left 0px top 0px"===msgBgPosition,onChange:function(){var _ref4=style_editor_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee4(e){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(!e.target.checked){_context4.next=5;break}return _context4.next=4,usersRef.doc(user.uid).update({msgBgPosition:"left 0px top 0px"});case 4:setMsgBgPosition("left 0px top 0px");case 5:case"end":return _context4.stop()}}),_callee4)})));return function(_x3){return _ref4.apply(this,arguments)}}(),disabled:!premium}),"Left"]}),Object(jsx_runtime.jsxs)("label",{onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:[Object(jsx_runtime.jsx)("input",{type:"radio",name:"msgBgPosition",defaultChecked:"right 0px top 0px"===msgBgPosition,onChange:function(){var _ref5=style_editor_dialog_asyncToGenerator(regeneratorRuntime.mark((function _callee5(e){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(!e.target.checked){_context5.next=5;break}return _context5.next=4,usersRef.doc(user.uid).update({msgBgPosition:"right 0px top 0px"});case 4:setMsgBgPosition("right 0px top 0px");case 5:case"end":return _context5.stop()}}),_callee5)})));return function(_x4){return _ref5.apply(this,arguments)}}(),disabled:!premium}),"Right"]})]}),Object(jsx_runtime.jsxs)("label",{onClick:function onClick(){if(!premium)return setPremiumPromptOpen(!0)},children:["Image transparency",Object(jsx_runtime.jsx)(SliderInput,{min:"0",max:"100",defaultValue:100*msgBgImgTransparency,onChange:function onChange(e){setMsgBgImgTransparency(e.target.value/100)},onChangeComplete:function onChangeComplete(e){usersRef.doc(user.uid).update({msgBgImgTransparency:e.target.value/100})},disabled:!premium})]})]})]})}ProfileDialog.__docgenInfo={description:"",methods:[],displayName:"ProfileDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\profile-dialog.jsx"]={name:"ProfileDialog",docgenInfo:ProfileDialog.__docgenInfo,path:"src\\components\\profile-dialog.jsx"}),ColorInput.displayName="ColorInput",ColorInput.__docgenInfo={description:"",methods:[],displayName:"ColorInput"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\color-input.jsx"]={name:"ColorInput",docgenInfo:ColorInput.__docgenInfo,path:"src\\components\\color-input.jsx"}),SliderInput.displayName="SliderInput",SliderInput.__docgenInfo={description:"",methods:[],displayName:"SliderInput"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\slider-input.jsx"]={name:"SliderInput",docgenInfo:SliderInput.__docgenInfo,path:"src\\components\\slider-input.jsx"}),StyleEditorDialog.__docgenInfo={description:"",methods:[],displayName:"StyleEditorDialog"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\style-editor-dialog.jsx"]={name:"StyleEditorDialog",docgenInfo:StyleEditorDialog.__docgenInfo,path:"src\\components\\style-editor-dialog.jsx"});var Add=__webpack_require__(571),Add_default=__webpack_require__.n(Add),ArrowDropDown=__webpack_require__(366),ArrowDropDown_default=__webpack_require__.n(ArrowDropDown),FormatColorText=__webpack_require__(572),FormatColorText_default=__webpack_require__.n(FormatColorText);function user_style_controls_toConsumableArray(arr){return function user_style_controls_arrayWithoutHoles(arr){if(Array.isArray(arr))return user_style_controls_arrayLikeToArray(arr)}(arr)||function user_style_controls_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function user_style_controls_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return user_style_controls_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return user_style_controls_arrayLikeToArray(o,minLen)}(arr)||function user_style_controls_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function user_style_controls_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function UserStyleControls(props){var uid=props.uid,isAnonymous=props.isAnonymous,setErrors=props.setErrors,stylesEnabled=props.stylesEnabled,setStylesEnabled=props.setStylesEnabled,open=props.open,premium=props.premium,setPremiumPromptOpen=props.setPremiumPromptOpen,menuOpenKey=props.menuOpenKey,font=props.font,setFont=props.setFont,fontSize=props.fontSize,setFontSize=props.setFontSize,fontColor=props.fontColor,setFontColor=props.setFontColor,toggleSelectionMarkup=props.toggleSelectionMarkup,setMessageValue=props.setMessageValue,setSelection=props.setSelection,isStyleEditorOpen=props.isStyleEditorOpen,setStyleEditorOpen=props.setStyleEditorOpen,enabled=stylesEnabled;return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:open&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a["format-controls"],children:[Object(jsx_runtime.jsx)("span",{onClickCapture:function onClickCapture(){if(isAnonymous)return setErrors(["Create an account to do that."]);var newValue=!enabled;usersRef.doc(uid).update({stylesEnabled:newValue}).then((function(){setStylesEnabled(newValue)}))},children:enabled?Object(jsx_runtime.jsx)(Close_default.a,{}):Object(jsx_runtime.jsx)(Add_default.a,{})}),enabled&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(MenuWithButton,{button:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["T",Object(jsx_runtime.jsx)(ArrowDropDown_default.a,{className:chat_room_module_default.a["down-arrow"]})]}),openKey:menuOpenKey,items:fonts.reduce((function(items,fontObj){return items[fontObj.name+(font.name===fontObj.name?" ✓":"")]=function(){if(isAnonymous)return setErrors(["Create an account to do that."]);usersRef.doc(uid).update({font:fontObj}).then((function(){setFont(fontObj)}))},items}),{})}),Object(jsx_runtime.jsx)(MenuWithButton,{button:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[fontSize,Object(jsx_runtime.jsx)(ArrowDropDown_default.a,{className:chat_room_module_default.a["down-arrow"]})]}),openKey:menuOpenKey,items:user_style_controls_toConsumableArray(Array(6).keys()).reduce((function(items,number){return items[9+number]=function(){if(isAnonymous)return setErrors(["Create an account to do that."]);usersRef.doc(uid).update({fontSize:9+number}).then((function(){setFontSize(9+number)}))},items}),{}),children:user_style_controls_toConsumableArray(Array(8).keys()).map((function(number,i){return Object(jsx_runtime.jsx)("div",{className:premium?"":chat_room_module_default.a.disabled,onClickCapture:function onClickCapture(){return isAnonymous?setErrors(["Create an account to do that."]):premium?void usersRef.doc(uid).update({fontSize:15+number}).then((function(){setFontSize(15+number)})):setPremiumPromptOpen(!0)},children:15+number},"premium-"+i)}))}),Object(jsx_runtime.jsx)("strong",{onClick:function onClick(){var result=toggleSelectionMarkup(MARKUP_SYMBOLS.BOLD);setMessageValue(result.value),setSelection({start:result.start,end:result.end})},children:"B"}),Object(jsx_runtime.jsx)("em",{onClick:function onClick(){var result=toggleSelectionMarkup(MARKUP_SYMBOLS.ITALICS);setMessageValue(result.value),setSelection({start:result.start,end:result.end})},children:"i"}),Object(jsx_runtime.jsx)("span",{onClickCapture:function onClickCapture(){if(isAnonymous)return setErrors(["Create an account to do that."]);setStyleEditorOpen(!isStyleEditorOpen)},children:"bg"}),Object(jsx_runtime.jsx)(MenuWithButton,{button:Object(jsx_runtime.jsx)(FormatColorText_default.a,{className:chat_room_module_default.a["font-color"],style:{color:fontColor}}),openKey:menuOpenKey,keepOpen:!0,children:Object(jsx_runtime.jsx)(ColorInput,{defaultValue:fontColor,onChange:function onChange(e){if(isAnonymous)return setErrors(["Create an account to do that."]);setFontColor(e.target.value)},onChangeComplete:function onChangeComplete(e){if(isAnonymous)return setErrors(["Create an account to do that."]);usersRef.doc(uid).update({fontColor:e.target.value})},onClick:function onClick(e){if(e.stopPropagation(),isAnonymous)return setErrors(["Create an account to do that."])}})})]})]})})}function chat_room_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function chat_room_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){chat_room_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){chat_room_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function chat_room_slicedToArray(arr,i){return function chat_room_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function chat_room_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function chat_room_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return chat_room_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return chat_room_arrayLikeToArray(o,minLen)}(arr,i)||function chat_room_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function chat_room_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function ChatRoom(props){var sendMessageCloud=dist_index_esm.a.functions().httpsCallable("sendMessage"),messagesRef=props.messagesRef,conversationRef=props.conversationRef,authUser=props.user,_useDocument2=chat_room_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.b)(usersRef.doc(authUser.uid)),2),userSnapshot=_useDocument2[0],isLoadingUser=_useDocument2[1],user=Object.assign({uid:authUser.uid,photoUrl:authUser.photoURL,email:authUser.email,emailVerified:authUser.emailVerified},userSnapshot?userSnapshot.data():{}),query=user?conversationsRef.where("userIds","array-contains",user.uid).orderBy("lastMessageSentAt","desc").limit(10):null,conversations=chat_room_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.a)(query,{idField:"id"}),1)[0],unreadCount=conversations?conversations.reduce((function(unreadCount,conversation){var lastReadAt=conversation.users[user.uid].lastReadAt,isUnread=!1;return null!==lastReadAt&&(isUnread=conversation.lastMessageSentAt>lastReadAt),isUnread?unreadCount+1:unreadCount}),0):0,_useState2=chat_room_slicedToArray(Object(react.useState)([]),2),errors=_useState2[0],setErrors=_useState2[1],_useState4=chat_room_slicedToArray(Object(react.useState)(!1),2),premium=_useState4[0],setPremium=_useState4[1],_useState6=chat_room_slicedToArray(Object(react.useState)(!0),2),isOnline=_useState6[0],setIsOnline=_useState6[1],_useState8=chat_room_slicedToArray(Object(react.useState)(""),2),messageValue=_useState8[0],setMessageValue=_useState8[1],_useState10=chat_room_slicedToArray(Object(react.useState)([]),2),onlineUsers=_useState10[0],setOnlineUsers=_useState10[1],_useState12=chat_room_slicedToArray(Object(react.useState)(user.photoUrl),2),photoUrl=_useState12[0],setPhotoUrl=_useState12[1],_useState14=chat_room_slicedToArray(Object(react.useState)(fonts[0]),2),font=_useState14[0],setFont=_useState14[1],_useState16=chat_room_slicedToArray(Object(react.useState)(13),2),fontSize=_useState16[0],setFontSize=_useState16[1],_useState18=chat_room_slicedToArray(Object(react.useState)("#000000"),2),fontColor=_useState18[0],setFontColor=_useState18[1],_useState20=chat_room_slicedToArray(Object(react.useState)("#000000"),2),nameColor=_useState20[0],setNameColor=_useState20[1],_useState22=chat_room_slicedToArray(Object(react.useState)(""),2),msgBgImg=_useState22[0],setMsgBgImg=_useState22[1],_useState24=chat_room_slicedToArray(Object(react.useState)("#FFFFFF"),2),msgBgColor=_useState24[0],setMsgBgColor=_useState24[1],_useState26=chat_room_slicedToArray(Object(react.useState)(1),2),msgBgTransparency=_useState26[0],setMsgBgTransparency=_useState26[1],_useState28=chat_room_slicedToArray(Object(react.useState)("no-repeat"),2),msgBgRepeat=_useState28[0],setMsgBgRepeat=_useState28[1],_useState30=chat_room_slicedToArray(Object(react.useState)("left 0px top 0px"),2),msgBgPosition=_useState30[0],setMsgBgPosition=_useState30[1],_useState32=chat_room_slicedToArray(Object(react.useState)(1),2),msgBgImgTransparency=_useState32[0],setMsgBgImgTransparency=_useState32[1],_useState34=chat_room_slicedToArray(Object(react.useState)(!0),2),stylesEnabled=_useState34[0],setStylesEnabled=_useState34[1],_useState36=chat_room_slicedToArray(Object(react.useState)(!1),2),isPremiumPromptOpen=_useState36[0],setPremiumPromptOpen=_useState36[1],_useState38=chat_room_slicedToArray(Object(react.useState)(!1),2),isPremiumOpen=_useState38[0],setPremiumOpen=_useState38[1],_useState40=chat_room_slicedToArray(Object(react.useState)(!1),2),isDmsOpen=_useState40[0],setDmsOpen=_useState40[1],_useState42=chat_room_slicedToArray(Object(react.useState)(!1),2),isUsersOpen=_useState42[0],setUsersOpen=_useState42[1],_useState44=chat_room_slicedToArray(Object(react.useState)(!1),2),isBanlistOpen=_useState44[0],setBanlistOpen=_useState44[1],_useState46=chat_room_slicedToArray(Object(react.useState)(!1),2),isModsOpen=_useState46[0],setModsOpen=_useState46[1],_useState48=chat_room_slicedToArray(Object(react.useState)(!1),2),isModActionLogOpen=_useState48[0],setModActionLogOpen=_useState48[1],_useState50=chat_room_slicedToArray(Object(react.useState)(!1),2),isFilteredWordsOpen=_useState50[0],setFilteredWordsOpen=_useState50[1],_useState52=chat_room_slicedToArray(Object(react.useState)(0),2),menuOpenKey=_useState52[0],setMenuOpenKey=_useState52[1],_useState54=chat_room_slicedToArray(Object(react.useState)(!1),2),isEmojisOpen=_useState54[0],setEmojisOpen=_useState54[1],_useState56=chat_room_slicedToArray(Object(react.useState)(!1),2),isFormatOpen=_useState56[0],setFormatOpen=_useState56[1],_useState58=chat_room_slicedToArray(Object(react.useState)(!1),2),isStyleEditorOpen=_useState58[0],setStyleEditorOpen=_useState58[1],_useState60=chat_room_slicedToArray(Object(react.useState)(!1),2),isProfileOpen=_useState60[0],setProfileOpen=_useState60[1],_useState62=chat_room_slicedToArray(Object(react.useState)({start:0,end:0}),2),selection=_useState62[0],setSelection=_useState62[1],_useState64=chat_room_slicedToArray(Object(react.useState)(0),2),sentMsgCount=_useState64[0],setSentMsgCount=_useState64[1],messageInput=Object(react.useRef)(),sendMessage=function(){var _ref=chat_room_asyncToGenerator(regeneratorRuntime.mark((function _callee(e){var text;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(conversationRef&&!user.emailVerified&&setErrors(["Verify your email to do that."]),!messageValue){_context.next=8;break}return e.preventDefault(),text=messageValue,setMessageValue(""),_context.next=7,sendMessageCloud({conversationId:conversationRef?conversationRef.id:messagesRef.id,text:text,isDeleted:!1,font:font,fontSize:fontSize,fontColor:fontColor,backgroundImage:msgBgImg,bgColor:msgBgColor,nameColor:nameColor,bgTransparency:msgBgTransparency,msgBgRepeat:msgBgRepeat,msgBgPosition:msgBgPosition,msgBgImgTransparency:msgBgImgTransparency});case 7:setSentMsgCount(sentMsgCount+1);case 8:case"end":return _context.stop()}}),_callee)})));return function sendMessage(_x){return _ref.apply(this,arguments)}}();query=messagesRef.limit(25).orderBy("createdAt","desc").where("isDeleted","==",!1);var messages=chat_room_slicedToArray(Object(react_firebase_hooks_firestore_dist_index_esm.a)(query,{idField:"id"}),1)[0];return Object(react.useEffect)((function(){if(!isLoadingUser&&user.username){usersRef.doc(user.uid).get().then((function(doc){if(doc.exists){var preferences=doc.data();"fontSize"in preferences&&setFontSize(preferences.fontSize),"fontColor"in preferences&&setFontColor(preferences.fontColor),"font"in preferences&&setFont(preferences.font),"stylesEnabled"in preferences&&setStylesEnabled(preferences.stylesEnabled),"msgBgImg"in preferences&&setMsgBgImg(preferences.msgBgImg),"nameColor"in preferences&&setNameColor(preferences.nameColor),"msgBgColor"in preferences&&setMsgBgColor(preferences.msgBgColor),"msgBgTransparency"in preferences&&setMsgBgTransparency(preferences.msgBgTransparency),"msgBgRepeat"in preferences&&setMsgBgRepeat(preferences.msgBgRepeat),"msgBgPosition"in preferences&&setMsgBgPosition(preferences.msgBgPosition),"msgBgImgTransparency"in preferences&&setMsgBgImgTransparency(preferences.msgBgImgTransparency)}}));var unsubPresence=function presence(uid,username,setIsOnline){var offlineTimeout=null,disconnectRef=null,unsubPresence=null,userPresenceDatabaseRef=null,userPresenceRef=null,isOfflineForDatabase={isOnline:!1,lastChanged:dist_index_esm.a.database.ServerValue.TIMESTAMP,username:username},isOnlineForDatabase={isOnline:!0,lastChanged:dist_index_esm.a.database.ServerValue.TIMESTAMP,username:username},isOfflineForFirestore={isOnline:!1,lastChanged:dist_index_esm.a.firestore.FieldValue.serverTimestamp(),username:username},isOnlineForFirestore={isOnline:!0,lastChanged:dist_index_esm.a.firestore.FieldValue.serverTimestamp(),username:username};uid&&subscribe(uid);var unsubToken=dist_index_esm.a.auth().onIdTokenChanged((function(user){user?null==uid&&subscribe(uid=user.uid):(userPresenceDatabaseRef.set(isOfflineForDatabase),unsubscribe(),uid=null)}));function subscribe(uid){userPresenceDatabaseRef=dist_index_esm.a.database().ref("/userPresences/"+uid),userPresenceRef=dist_index_esm.a.firestore().doc("/userPresences/"+uid),dist_index_esm.a.database().ref(".info/connected").on("value",(function(snapshot){!1!==snapshot.val()?(disconnectRef=userPresenceDatabaseRef.onDisconnect()).set(isOfflineForDatabase).then((function(temp){userPresenceDatabaseRef.set(isOnlineForDatabase),userPresenceRef.set(isOnlineForFirestore)})):userPresenceRef.set(isOfflineForFirestore)})),unsubPresence=userPresenceRef.onSnapshot((function(doc){doc.data()&&(doc.data().isOnline?null!==offlineTimeout&&(clearTimeout(offlineTimeout),offlineTimeout=null,setIsOnline(!0)):null===offlineTimeout&&(offlineTimeout=setTimeout((function(){setIsOnline(!1)}),3e3)))}))}function unsubscribe(){disconnectRef&&disconnectRef.cancel(),dist_index_esm.a.database().ref(".info/connected").off("value"),unsubPresence&&unsubPresence(),unsubToken&&unsubToken()}return unsubscribe}(user.uid,user.username,setIsOnline),unsubOnlineUsers=dist_index_esm.a.firestore().collection("userPresences").where("isOnline","==",!0).onSnapshot((function(snapshot){setOnlineUsers(snapshot.docs.map((function(doc){return doc.data()})))}));return function fetchPremium(){return _fetchPremium.apply(this,arguments)}(),function(){unsubPresence(),unsubOnlineUsers()}}function _fetchPremium(){return(_fetchPremium=chat_room_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var idTokenResult;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,dist_index_esm.a.auth().currentUser.getIdTokenResult();case 2:idTokenResult=_context2.sent,setPremium("premium"===idTokenResult.claims.stripeRole);case 4:case"end":return _context2.stop()}}),_callee2)})))).apply(this,arguments)}}),[isLoadingUser,user.uid,user.username]),Object(react.useEffect)((function(){if(selection){var start=selection.start,end=selection.end;messageInput.focus(),messageInput.setSelectionRange(start,end)}}),[selection]),Object(react.useEffect)((function(){function _markMessagesRead(){return(_markMessagesRead=chat_room_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _users;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,conversationRef.set({users:(_users={},_users[user.uid]={lastReadAt:dist_index_esm.a.firestore.FieldValue.serverTimestamp()},_users)},{merge:!0});case 2:case"end":return _context3.stop()}}),_callee3)})))).apply(this,arguments)}props.dms&&function markMessagesRead(){return _markMessagesRead.apply(this,arguments)}()}),[props.dms,conversationRef,user.uid]),Object(jsx_runtime.jsxs)("section",{className:chat_room_module_default.a["chat-section"],onClickCapture:function closeMenus(){setMenuOpenKey(menuOpenKey+1)},children:[Object(jsx_runtime.jsxs)("header",{children:[props.header," ",props.dms&&Object(jsx_runtime.jsx)(Close_default.a,{className:chat_room_module_default.a.pointer,onClick:function onClick(){props.setDmMessagesRef(null)}})]}),Object(jsx_runtime.jsx)(MessageList,{setErrors:setErrors,setAlerts:props.setAlerts,messagesRef:messagesRef,defaultMessages:messages,scrollToBottom:!0,stylesEnabled:stylesEnabled,onMessageClick:function onMessageClick(targetUsername){setMessageValue(messageValue+" @"+targetUsername+" "),messageInput.focus()},sentMsgCount:sentMsgCount,currentUser:user}),Object(jsx_runtime.jsx)(UserStyleControls,{uid:user.uid,open:isFormatOpen,premium:premium,isAnonymous:null==user.email,menuOpenKey:menuOpenKey,setMenuOpenKey:setMenuOpenKey,setErrors:setErrors,stylesEnabled:stylesEnabled,setStylesEnabled:setStylesEnabled,font:font,setFont:setFont,fontSize:fontSize,setFontSize:setFontSize,messageInput:messageInput,setMessageValue:setMessageValue,setStyleEditorOpen:setStyleEditorOpen,isStyleEditorOpen:isStyleEditorOpen,fontColor:fontColor,setFontColor:setFontColor,toggleSelectionMarkup:function toggleSelectionMarkup(symbol){return markdown_toggleSelectionMarkup(messageInput,symbol)},setSelection:setSelection,setPremiumPromptOpen:setPremiumPromptOpen}),Object(jsx_runtime.jsx)(MessageInputForm,{premium:premium,sendMessage:sendMessage,setMessageInput:function setMessageInput(input){messageInput=input},messageValue:messageValue,setErrors:setErrors,setMessageValue:setMessageValue,setSelection:setSelection,toggleSelectionMarkup:function toggleSelectionMarkup(symbol){return markdown_toggleSelectionMarkup(messageInput,symbol)},stylesEnabled:stylesEnabled,font:font,fontSize:fontSize,fontColor:fontColor,msgBgImg:msgBgImg,msgBgTransparency:msgBgTransparency,msgBgColor:msgBgColor,msgBgRepeat:msgBgRepeat,msgBgPosition:msgBgPosition,isEmojisOpen:isEmojisOpen,setEmojisOpen:setEmojisOpen,isFormatOpen:isFormatOpen,setFormatOpen:setFormatOpen,msgBgImgTransparency:msgBgImgTransparency}),Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a["chat-controls"],children:[Object(jsx_runtime.jsx)("span",{className:chat_room_module_default.a.pointer+" "+chat_room_module_default.a["user-count"],onClick:function onClick(){setUsersOpen(!isUsersOpen)},children:onlineUsers?onlineUsers.length:1}),Object(jsx_runtime.jsx)("span",{className:chat_room_module_default.a.badge+" "+chat_room_module_default.a.pointer,"data-badge-text":unreadCount||"",onClick:function onClick(){setDmsOpen(!isDmsOpen)},children:Object(jsx_runtime.jsx)(ChatBubble_default.a,{className:chat_room_module_default.a.pointer+" "+chat_room_module_default.a["chat-bubble-icon"]+" "+(unreadCount?chat_room_module_default.a.yellow:"")})}),user.isModerator&&Object(jsx_runtime.jsx)(MenuWithButton,{button:Object(jsx_runtime.jsx)(Gavel_default.a,{className:chat_room_module_default.a["gavel-icon"]}),openKey:menuOpenKey,items:Object.assign({"Manage Moderators":function ManageModerators(){setModsOpen(!isModsOpen)},Banlist:function Banlist(){setBanlistOpen(!isBanlistOpen)}},user.isAdmin?{"Mod Action Log":function ModActionLog(){setModActionLogOpen(!isModActionLogOpen)},"Filtered words":function FilteredWords(){setFilteredWordsOpen(!isFilteredWordsOpen)}}:{})}),Object(jsx_runtime.jsx)(MenuWithButton,{button:Object(jsx_runtime.jsx)(Menu_default.a,{}),openKey:menuOpenKey,items:{"Log out":function LogOut(){props.logout()},"Edit profile":function EditProfile(){setProfileOpen(!isProfileOpen)},Premium:function Premium(){setPremiumOpen(!isPremiumOpen)}}})]}),Object(jsx_runtime.jsx)(StyleEditorDialog,{open:isStyleEditorOpen,premium:premium,requestClose:function requestClose(){setStyleEditorOpen(!1)},setErrors:setErrors,setPremiumPromptOpen:setPremiumPromptOpen,messagesRef:messagesRef,user:user,fontSize:fontSize,fontColor:fontColor,font:font,msgBgImg:msgBgImg,nameColor:nameColor,msgBgColor:msgBgColor,msgBgTransparency:msgBgTransparency,msgBgRepeat:msgBgRepeat,msgBgPosition:msgBgPosition,msgBgImgTransparency:msgBgImgTransparency,stylesEnabled:stylesEnabled,setNameColor:setNameColor,setMsgBgColor:setMsgBgColor,setMsgBgTransparency:setMsgBgTransparency,setMsgBgImg:setMsgBgImg,setMsgBgRepeat:setMsgBgRepeat,setMsgBgPosition:setMsgBgPosition,setMsgBgImgTransparency:setMsgBgImgTransparency}),isUsersOpen&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog,children:[Object(jsx_runtime.jsxs)("header",{children:["People here now",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setUsersOpen(!1)}})]}),Object(jsx_runtime.jsx)("ul",{children:onlineUsers.map((function(user,i){return Object(jsx_runtime.jsx)("li",{children:user.username},i)}))})]}),Object(jsx_runtime.jsx)(DmsDialog,{open:isDmsOpen,username:user.username,uid:user.uid,setConversationRef:props.setConversationRef,setDmMessagesRef:props.setDmMessagesRef,conversations:conversations,itemsPerPage:10,requestClose:function requestClose(){setDmsOpen(!1)}}),Object(jsx_runtime.jsx)(ModeratorsDialog,{open:isModsOpen,requestClose:function requestClose(){setModsOpen(!1)}}),Object(jsx_runtime.jsx)(BanlistDialog,{open:isBanlistOpen,requestClose:function requestClose(){setBanlistOpen(!1)}}),Object(jsx_runtime.jsx)(ModActionLogDialog,{open:isModActionLogOpen,requestClose:function requestClose(){setModActionLogOpen(!1)}}),Object(jsx_runtime.jsx)(FilteredWordsDialog,{open:isFilteredWordsOpen,requestClose:function requestClose(){setFilteredWordsOpen(!1)}}),Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog+" "+(isEmojisOpen?"":chat_room_module_default.a.hidden),children:[Object(jsx_runtime.jsxs)("header",{children:["Emojis",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setEmojisOpen(!1)}})]}),Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(EmojiSelector,{isAnonymous:null==user.email,setErrors:setErrors,onSelect:function onSelect(emojiChar){messageInput.focus(),function insertIntoInput(newText){var el=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.activeElement;if(el.setRangeText){var _ref=[el.selectionStart,el.selectionEnd],start=_ref[0],end=_ref[1];el.setRangeText(newText,start,end,"end")}else el.value+=newText+" "}(emojiChar+" ",messageInput),setMessageValue(messageInput.value)},setPremiumPromptOpen:setPremiumPromptOpen,setPremiumOpen:setPremiumOpen,messageValue:messageValue,setMessageValue:setMessageValue,messageInput:messageInput,shouldComponentUpdate:!1,premium:premium})})]}),Object(jsx_runtime.jsx)(ProfileDialog,{open:isProfileOpen,requestClose:function requestClose(){setProfileOpen(!1)},setErrors:setErrors,setAlerts:props.setAlerts,photoUrl:photoUrl,setPhotoUrl:setPhotoUrl,isVerified:user.emailVerified}),isPremiumPromptOpen&&Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a.dialog,children:[Object(jsx_runtime.jsxs)("header",{children:["Premium Feature",Object(jsx_runtime.jsx)(Close_default.a,{onClick:function onClick(){setPremiumPromptOpen(!1)}})]}),Object(jsx_runtime.jsxs)("main",{children:["You must be a Premium user to do that!",Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:function onClick(){setPremiumPromptOpen(!1),setPremiumOpen(!0)},children:"Upgrade now!"})]})]}),Object(jsx_runtime.jsx)(PremiumDialog,{open:isPremiumOpen,isAnonymous:null==user.email,uid:user.uid,premium:premium,requestClose:function requestClose(){setPremiumOpen(!1)}}),Object(jsx_runtime.jsx)(ErrorDialog,{errors:errors,requestClose:function requestClose(){setErrors([])}}),!isOnline&&Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["chat-room-overlay"],children:Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a["overlay-message"],children:[Object(jsx_runtime.jsx)("div",{children:"Connection failed."}),Object(jsx_runtime.jsx)("div",{children:"Attemtping reconnect..."})]})})]})}function sign_in_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function sign_in_form_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){sign_in_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){sign_in_form_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function sign_in_form_slicedToArray(arr,i){return function sign_in_form_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function sign_in_form_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function sign_in_form_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return sign_in_form_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sign_in_form_arrayLikeToArray(o,minLen)}(arr,i)||function sign_in_form_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sign_in_form_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SignInForm(props){var _useState2=sign_in_form_slicedToArray(Object(react.useState)(""),2),username=_useState2[0],setUsername=_useState2[1],_useState4=sign_in_form_slicedToArray(Object(react.useState)(props.email),2),email=_useState4[0],setEmail=_useState4[1],_useState6=sign_in_form_slicedToArray(Object(react.useState)(""),2),password=_useState6[0],setPassword=_useState6[1],_useState8=sign_in_form_slicedToArray(Object(react.useState)(!1),2),isNewUser=_useState8[0],setIsNewUser=_useState8[1],_useState10=sign_in_form_slicedToArray(Object(react.useState)(!1),2),forgotPassword=_useState10[0],setForgotPassword=_useState10[1],_useState12=sign_in_form_slicedToArray(Object(react.useState)(""),2),passwordResetLink=_useState12[0],setPasswordResetLink=_useState12[1],_useState14=sign_in_form_slicedToArray(Object(react.useState)([]),2),errors=_useState14[0],setErrors=_useState14[1],_useState16=sign_in_form_slicedToArray(Object(react.useState)(!1),2),loading=_useState16[0],setLoading=_useState16[1],url=new URL(window.location);if(url.searchParams.get("chat-reset-password")&&!passwordResetLink){var link=decodeURIComponent(url.searchParams.get("chat-reset-password"));setPasswordResetLink(link),props.logout()}return Object(jsx_runtime.jsx)("form",{className:chat_room_module_default.a["login-form"],onSubmit:function onSubmit(e){e.preventDefault(),loading||(setLoading(!0),setErrors([]),timeout(1e4,sign_in_form_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _link,response,sendPasswordResetEmail,result,signUp,_result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!passwordResetLink){_context.next=19;break}if(!(password.length<8)){_context.next=3;break}throw new Error("Password must be 8+ characters.");case 3:return(_link=new URL(passwordResetLink)).searchParams.set("newPassword",password),_context.next=7,fetch(_link);case 7:if((response=_context.sent).ok){_context.next=12;break}throw setQueryParam("chat-reset-password",null),setPasswordResetLink(""),new Error("Password reset request expired. Please initiate a new reset request.");case 12:return _context.next=14,response.json();case 14:return props.setAlerts(["Password reset successful!"]),setQueryParam("chat-reset-password",null),setPasswordResetLink(""),setLoading(!1),_context.abrupt("return");case 19:if(!forgotPassword){_context.next=31;break}return sendPasswordResetEmail=dist_index_esm.a.app().functions().httpsCallable("sendPasswordResetEmail"),_context.next=23,sendPasswordResetEmail({email:email,returnUrl:window.location.href});case 23:if(!(result=_context.sent).data.error){_context.next=28;break}throw result.data.error;case 28:props.setAlerts([result.data.message]);case 29:return setLoading(!1),_context.abrupt("return");case 31:if(!isNewUser){_context.next=39;break}return signUp=dist_index_esm.a.app().functions().httpsCallable("signUp"),_context.next=35,signUp({email:email,password:password,username:username,returnUrl:window.location.href});case 35:if(!(_result=_context.sent).data.error){_context.next=38;break}throw _result.data.error;case 38:props.setAlerts(["Signup complete! Check your inbox to complete your email verification."]);case 39:return _context.next=41,auth.signInWithEmailAndPassword(email,password).catch((function(error){setErrors([translateError(error).message]),setLoading(!1)}));case 41:case"end":return _context.stop()}}),_callee)})))).catch((function(error){setErrors([translateError(error).message]),setLoading(!1)})))},children:Object(jsx_runtime.jsxs)("fieldset",{disabled:loading,children:[errors.map((function(error,i){return Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a.error,children:error},i)})),loading&&Object(jsx_runtime.jsx)("div",{className:chat_room_module_default.a["loading-placeholder"]}),!passwordResetLink&&Object(jsx_runtime.jsx)("label",{className:isNewUser?chat_room_module_default.a["info-tooltip"]:"","data-text":"Email verification will be required.",children:Object(jsx_runtime.jsx)("input",{type:"email",name:"email",autoComplete:"username",value:email,onChange:function onChange(e){setEmail(e.target.value)},placeholder:"Email"})}),!forgotPassword&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[isNewUser&&!passwordResetLink&&Object(jsx_runtime.jsx)("input",{id:"username",autoComplete:"username",type:"text",name:"username",value:username,onChange:function onChange(e){setUsername(e.target.value)},placeholder:"Username"}),Object(jsx_runtime.jsx)("input",{id:"current-password",autoComplete:"current-password",type:"password",name:"password",value:password,onChange:function onChange(e){setPassword(e.target.value)},placeholder:"Password"})]}),passwordResetLink?Object(jsx_runtime.jsx)("button",{children:"Complete Password Reset"}):forgotPassword?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("button",{children:"Reset Password"}),Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:function onClick(e){e.preventDefault(),loading||(setErrors([]),setForgotPassword(!1))},children:"Signup/login"})]}):isNewUser?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("button",{children:"Sign Up"}),Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:function onClick(e){e.preventDefault(),loading||(setIsNewUser(!1),setErrors([]))},children:"Existing user?"})]}):Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("button",{children:"Sign In"}),Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:function onClick(e){e.preventDefault(),loading||(setIsNewUser(!0),setErrors([]))},children:"New user?"}),Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a.link,onClick:function onClick(e){e.preventDefault(),loading||(setErrors([]),setForgotPassword(!0))},children:"Forgot your password?"})]}),!passwordResetLink&&!forgotPassword&&Object(jsx_runtime.jsx)("button",{className:chat_room_module_default.a["sign-in"],onClick:function onClick(e){e.preventDefault(),loading||(setLoading(!0),setErrors([]),timeout(1e4,sign_in_form_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var signUp,result;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return signUp=dist_index_esm.a.app().functions().httpsCallable("signUp"),_context2.next=3,signUp({anonymous:!0});case 3:if(!(result=_context2.sent).data.error){_context2.next=6;break}throw result.data.error;case 6:return _context2.next=8,auth.signInWithCustomToken(result.data.token).catch((function(error){setErrors(["Something went wrong. Please try again."]),setLoading(!1)}));case 8:case"end":return _context2.stop()}}),_callee2)})))).catch((function(error){setErrors([translateError(error).message]),setLoading(!1)})))},children:"Chat Anonymously"})]})})}function chat_room_app_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function chat_room_app_slicedToArray(arr,i){return function chat_room_app_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function chat_room_app_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function chat_room_app_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return chat_room_app_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return chat_room_app_arrayLikeToArray(o,minLen)}(arr,i)||function chat_room_app_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function chat_room_app_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}UserStyleControls.__docgenInfo={description:"",methods:[],displayName:"UserStyleControls"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\user-style-controls.jsx"]={name:"UserStyleControls",docgenInfo:UserStyleControls.__docgenInfo,path:"src\\components\\user-style-controls.jsx"}),ChatRoom.displayName="ChatRoom",ChatRoom.__docgenInfo={description:"",methods:[],displayName:"ChatRoom"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\chat-room.jsx"]={name:"ChatRoom",docgenInfo:ChatRoom.__docgenInfo,path:"src\\components\\chat-room.jsx"}),SignInForm.displayName="SignInForm",SignInForm.__docgenInfo={description:"",methods:[],displayName:"SignInForm"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\sign-in-form.jsx"]={name:"SignInForm",docgenInfo:SignInForm.__docgenInfo,path:"src\\components\\sign-in-form.jsx"});dist_index_esm.a.initializeApp({name:"stream-site-9ebd9",apiKey:"AIzaSyB4dhrVHT9oeRUNf7wi-Zs6pnnq2xZ80YM",authDomain:"stream-site-9ebd9",projectId:"stream-site-9ebd9",storageBucket:"stream-site-9ebd9.appspot.com",databaseURL:"localhost"===window.location.hostname?"http://localhost:9000/?ns=stream-site-9ebd9-default-rtdb":"https://stream-site-9ebd9-default-rtdb.firebaseio.com",messagingSenderId:"1008086677721",appId:"1:1008086677721:web:e8ee668830765c3df626c8",measurementId:"G-T9226MT70Q"});var firestore=dist_index_esm.a.firestore(),functions=(dist_index_esm.a.analytics(),dist_index_esm.a.functions()),auth=dist_index_esm.a.auth(),storage=dist_index_esm.a.storage(),db=dist_index_esm.a.database();"localhost"===window.location.hostname&&(auth.useEmulator("http://localhost:9099"),firestore.useEmulator("localhost",8080),functions.useEmulator("localhost",5001),db.useEmulator("localhost",9e3),storage.useEmulator("localhost",9199));var conversationsRef=firestore.collection("conversations"),usersRef=firestore.collection("users"),modActionLogRef=firestore.collection("modActionLog"),settingsRef=firestore.collection("settings"),chat_room_app_messagesRef=firestore.collection("messages"),banUser=dist_index_esm.a.functions().httpsCallable("banUser"),unbanUser=dist_index_esm.a.functions().httpsCallable("unbanUser");dist_index_esm.a.functions().httpsCallable("ext-firestore-stripe-subscriptions-createPortalLink");function ChatRoomApp(){var user=chat_room_app_slicedToArray(Object(react_firebase_hooks_auth_dist_index_esm.a)(auth),1)[0],email=user&&!user.isAnonymous?user.email:"",_useState2=chat_room_app_slicedToArray(Object(react.useState)(null),2),conversationRef=_useState2[0],setConversationRef=_useState2[1],_useState4=chat_room_app_slicedToArray(Object(react.useState)(null),2),dmMessagesRef=_useState4[0],setDmMessagesRef=_useState4[1],_useState6=chat_room_app_slicedToArray(Object(react.useState)([]),2),alerts=_useState6[0],setAlerts=_useState6[1],logout=function(){var _ref=function chat_room_app_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){chat_room_app_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){chat_room_app_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,auth.signOut();case 2:setConversationRef(null),setDmMessagesRef(null);case 4:case"end":return _context.stop()}}),_callee)})));return function logout(){return _ref.apply(this,arguments)}}();Object(react.useEffect)((function(){var url=new URL(window.location);url.searchParams.get("chat-email-verified")&&(setAlerts(["Email verification successful!"]),setQueryParam("chat-email-verified",null)),url.searchParams.get("chat-logout")&&(setQueryParam("chat-logout",null),logout())}),[]);var header=conversationRef&&user?conversationRef.id.split(":").filter((function(e){return e!==user.displayName})).toString():"";return Object(jsx_runtime.jsxs)("div",{className:chat_room_module_default.a["chat-app"],children:[user?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:dmMessagesRef?Object(jsx_runtime.jsx)(ChatRoom,{user:user,setAlerts:setAlerts,conversationRef:conversationRef,setConversationRef:setConversationRef,messagesRef:dmMessagesRef,setDmMessagesRef:setDmMessagesRef,logout:logout,header:header,dms:!0}):Object(jsx_runtime.jsx)(ChatRoom,{user:user,setAlerts:setAlerts,messagesRef:chat_room_app_messagesRef,setConversationRef:setConversationRef,setDmMessagesRef:setDmMessagesRef,logout:logout})}):Object(jsx_runtime.jsx)(SignInForm,{email:email,setAlerts:setAlerts,logout:logout}),Object(jsx_runtime.jsx)(AlertDialog,{alerts:alerts,requestClose:function requestClose(){setAlerts([])}})]})}ChatRoomApp.displayName="ChatRoomApp",ChatRoomApp.__docgenInfo={description:"",methods:[],displayName:"ChatRoomApp"};"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src\\components\\chat-room-app.jsx"]={name:"ChatRoomApp",docgenInfo:ChatRoomApp.__docgenInfo,path:"src\\components\\chat-room-app.jsx"})},600:function(module,exports,__webpack_require__){__webpack_require__(601),__webpack_require__(756),__webpack_require__(757),__webpack_require__(1116),__webpack_require__(1117),__webpack_require__(1125),__webpack_require__(1126),__webpack_require__(1122),__webpack_require__(1118),__webpack_require__(1127),__webpack_require__(1119),__webpack_require__(1120),__webpack_require__(1128),module.exports=__webpack_require__(952)},63:function(module,exports,__webpack_require__){var api=__webpack_require__(248),content=__webpack_require__(962);"string"==typeof(content=content.__esModule?content.default:content)&&(content=[[module.i,content,""]]);var options={insert:"head",singleton:!1};api(content,options);module.exports=content.locals||{}},667:function(module,exports){},757:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(256)},952:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(256).configure)([__webpack_require__(953),__webpack_require__(954)],module,!1)}).call(this,__webpack_require__(196)(module))},953:function(module,exports){function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,module.exports=webpackEmptyContext,webpackEmptyContext.id=953},954:function(module,exports,__webpack_require__){var map={"./stories/chat-room-app.stories.js":955};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=954},955:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){__webpack_require__(0);var _storybook_react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(256),_components_chat_room_app__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(576),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_1__.storiesOf)("App Test",module).addParameters({storySource:{source:'import React from "react";\r\nimport { storiesOf } from "@storybook/react";\r\n\r\nimport { ChatRoomApp } from "../components/chat-room-app";\r\n\r\nconst stories = storiesOf("App Test", module);\r\n\r\nstories.add("App", () => {\r\n  return <ChatRoomApp />;\r\n});\r\n',locationsMap:{app:{startLoc:{col:12,line:8},endLoc:{col:1,line:10},startBody:{col:19,line:8},endBody:{col:1,line:10}}}}}).add("App",(function(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_components_chat_room_app__WEBPACK_IMPORTED_MODULE_2__.a,{})}))}.call(this,__webpack_require__(228)(module))},958:function(module,exports,__webpack_require__){(exports=__webpack_require__(249)(!1)).push([module.i,'a,\r\n.chat-room-module__chat-app__3_MzT *.chat-room-module__link__1wdhd {\r\n  color: #0084eb;\r\n  cursor: pointer;\r\n  padding: 0.25em 0.5em;\r\n  text-decoration: none;\r\n  background: none;\r\n}\r\n\r\n@-webkit-keyframes chat-room-module__rotation__2o1_l {\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n@keyframes chat-room-module__rotation__2o1_l {\r\n  from {\r\n    transform: rotate(0deg);\r\n  }\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\na:hover,\r\n.chat-room-module__chat-app__3_MzT *.chat-room-module__link__1wdhd:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\nul {\r\n  padding-left: 5px;\r\n}\r\n\r\n[type="text"],\r\n[type="password"],\r\n[type="email"],\r\n[type="number"],\r\n[type="range"],\r\n[type="color"] {\r\n  padding: 5px;\r\n  border: 1px solid #ccc;\r\n  margin: 0px;\r\n}\r\n\r\n[type="color"] {\r\n  height: 30px;\r\n  border-radius: 0px;\r\n  padding: 0 3px;\r\n  cursor: pointer;\r\n}\r\n\r\nlabel {\r\n  display: block;\r\n}\r\n\r\nlabel [type="file"] {\r\n  display: none;\r\n}\r\n\r\n.chat-room-module__chat-app__3_MzT svg.chat-room-module__outlined__2kjUk {\r\n  border: 1px solid;\r\n}\r\n\r\n.chat-room-module__bold__3OfSp {\r\n  font-weight: bold;\r\n}\r\n\r\n.chat-room-module__hidden__1Eq30 {\r\n  display: none;\r\n}\r\n\r\n.chat-room-module__loading-placeholder__3LcAq,\r\n.chat-room-module__loading__1jROU,\r\n.chat-room-module__chat-app__3_MzT *.chat-room-module__disabled__11rg9,\r\n.chat-room-module__chat-app__3_MzT *[disabled],\r\n.chat-room-module__chat-app__3_MzT fieldset[disabled] input,\r\n.chat-room-module__chat-app__3_MzT fieldset[disabled] button,\r\n.chat-room-module__chat-app__3_MzT fieldset.chat-room-module__disable__1gwvA input,\r\n.chat-room-module__chat-app__3_MzT fieldset.chat-room-module__disabled__11rg9 button {\r\n  color: grey;\r\n  cursor: default;\r\n}\r\n\r\n.chat-room-module__chat-app__3_MzT *.chat-room-module__disabled__11rg9:hover,\r\n.chat-room-module__chat-app__3_MzT fieldset.chat-room-module__disabled__11rg9 *:hover {\r\n  text-decoration: none;\r\n}\r\n\r\n.chat-room-module__loading-placeholder__3LcAq,\r\n.chat-room-module__loading__1jROU {\r\n  position: relative;\r\n  pointer-events: none;\r\n}\r\n\r\n.chat-room-module__loading-placeholder__3LcAq {\r\n  min-width: 1em;\r\n  min-height: 1em;\r\n}\r\n\r\n.chat-room-module__loading-placeholder__3LcAq > * {\r\n  visibility: hidden;\r\n}\r\n\r\n.chat-room-module__loading-placeholder__3LcAq::before,\r\n.chat-room-module__loading__1jROU::after {\r\n  content: "";\r\n  position: absolute;\r\n  margin: auto;\r\n  top: 0px;\r\n  bottom: 0px;\r\n  width: 1em;\r\n  height: 1em;\r\n  margin-left: 0.5em;\r\n  border-radius: 50%;\r\n  /* border: 0.1em solid #f3f3f3; */\r\n  border-top: 0.1em solid;\r\n  border-right: 0.2em solid;\r\n  border-bottom: 0.1em solid transparent;\r\n\r\n  -webkit-animation: chat-room-module__rotation__2o1_l 0.9s linear infinite;\r\n\r\n          animation: chat-room-module__rotation__2o1_l 0.9s linear infinite;\r\n}\r\n\r\n.chat-room-module__loading-placeholder__3LcAq::before {\r\n  box-sizing: border-box;\r\n  margin-left: auto;\r\n}\r\n\r\n.chat-room-module__tooltip__3bTWB,\r\n.chat-room-module__info-tooltip__1Yvsi {\r\n  position: relative; /* making the .tooltip span a container for the tooltip text */\r\n}\r\n\r\n.chat-room-module__info-tooltip__1Yvsi::after {\r\n  content: "!";\r\n  position: absolute;\r\n  right: 5px;\r\n\r\n  font-size: 0.8em;\r\n  font-weight: bold;\r\n  color: white;\r\n  background-color: rgb(223 223 223);\r\n  border-radius: 1.2em;\r\n  height: 1.2em;\r\n  width: 1.2em;\r\n  margin: auto;\r\n  top: 0px;\r\n  bottom: 0px;\r\n  pointer-events: none;\r\n}\r\n\r\n.chat-room-module__tooltip__3bTWB::before,\r\n.chat-room-module__info-tooltip__1Yvsi::before {\r\n  content: attr(data-text);\r\n  position: absolute;\r\n  top: -50%;\r\n  transform: translate(-50%, -50%);\r\n  left: 100%;\r\n  width: 200px;\r\n  padding: 6px;\r\n  border-radius: 2px;\r\n  background: #f5f5f5;\r\n  color: #7a7a7a;\r\n  text-align: center;\r\n  font-size: 0.8em;\r\n  border: 1px solid;\r\n\r\n  display: none; /* hide by default */\r\n}\r\n\r\n.chat-room-module__tooltip__3bTWB:hover::before,\r\n.chat-room-module__info-tooltip__1Yvsi:hover::before {\r\n  display: block;\r\n}\r\n\r\n.chat-room-module__yellow__2g5Cj {\r\n  color: yellow;\r\n}\r\n\r\n.chat-room-module__badge__3pH8P {\r\n  position: relative;\r\n}\r\n\r\n.chat-room-module__badge__3pH8P::after {\r\n  content: attr(data-badge-text);\r\n  position: absolute;\r\n  display: flex;\r\n  color: black;\r\n  justify-content: center;\r\n  align-items: center;\r\n  font-size: 0.7em;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0px;\r\n  top: 0px;\r\n  margin-top: -1px;\r\n}\r\n\r\n.chat-room-module__slider__1-3ub {\r\n  -webkit-appearance: none;\r\n  width: 100%;\r\n  height: 30px;\r\n  background: #d3d3d3;\r\n  outline: none;\r\n}\r\n\r\n.chat-room-module__slider__1-3ub::-webkit-slider-thumb {\r\n  -webkit-appearance: none;\r\n  appearance: none;\r\n  cursor: pointer;\r\n  margin-top: 35px;\r\n\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 5px solid transparent;\r\n  border-right: 5px solid transparent;\r\n\r\n  border-bottom: 5px solid black;\r\n}\r\n\r\n.chat-room-module__slider__1-3ub[disabled]::-webkit-slider-thumb {\r\n  cursor: default;\r\n}\r\n\r\n.chat-room-module__slider__1-3ub::-moz-range-thumb {\r\n  cursor: pointer;\r\n  margin-top: 35px;\r\n\r\n  width: 0;\r\n  height: 0;\r\n  border-left: 5px solid transparent;\r\n  border-right: 5px solid transparent;\r\n\r\n  border-bottom: 5px solid black;\r\n}\r\n\r\n.chat-room-module__error__8krZC {\r\n  color: red;\r\n  font-size: 0.75em;\r\n}\r\n\r\n.chat-room-module__chat-app__3_MzT {\r\n  height: 100%;\r\n  max-width: 728px;\r\n  margin: 0 auto;\r\n  background-color: black;\r\n  font-family: sans-serif;\r\n  padding: 5px;\r\n\r\n  position: relative;\r\n\r\n  color: rgb(255, 121, 0);\r\n}\r\n\r\n.chat-room-module__chat-app__3_MzT header {\r\n  /* min-height: 20px;\r\n  color: white; */\r\n}\r\n\r\n.chat-room-module__chat-app__3_MzT {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.chat-room-module__chat-section__4_xYW {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  height: 100%;\r\n  width: 100%;\r\n}\r\n\r\n.chat-room-module__chat-section__4_xYW > header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.chat-room-module__chat-section__4_xYW > header > * {\r\n  vertical-align: middle;\r\n}\r\n\r\n.chat-room-module__messages-section__3Qu29 {\r\n  overflow-y: scroll;\r\n  display: flex;\r\n  flex-direction: column-reverse;\r\n  flex-grow: 1;\r\n  color: initial;\r\n  margin-bottom: 0.3em;\r\n  width: 100%;\r\n}\r\n\r\n.chat-room-module__messages-section__3Qu29 > :last-child {\r\n  margin-top: auto;\r\n}\r\n\r\n.chat-room-module__messages-section__3Qu29 > .chat-room-module__pagination-controls__1eIje {\r\n  display: flex;\r\n}\r\n\r\n.chat-room-module__messages-section__3Qu29 > .chat-room-module__pagination-controls__1eIje > button {\r\n  border-radius: 0px;\r\n  border: 1px solid grey;\r\n  flex-basis: 50%;\r\n  flex-grow: 1;\r\n}\r\n\r\n[data-format="*"] {\r\n  font-style: italic;\r\n}\r\n\r\n[data-format="**"] {\r\n  font-weight: bold;\r\n}\r\n\r\n[data-format="_"] {\r\n  text-decoration: underline;\r\n}\r\n\r\n.chat-room-module__menu__jFVYv {\r\n  position: absolute;\r\n  right: 0;\r\n  background: white;\r\n  border: 1px solid rgb(222, 222, 222);\r\n  bottom: 1.3em;\r\n  white-space: nowrap;\r\n}\r\n\r\n.chat-room-module__menu__jFVYv > * {\r\n  color: #0084eb;\r\n  cursor: pointer;\r\n  padding: 0.25em 0.5em;\r\n}\r\n\r\n.chat-room-module__menu__jFVYv > *:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.chat-room-module__menu__jFVYv > *:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.chat-room-module__button__ckGwu {\r\n  display: inline-block;\r\n  text-align: center;\r\n  padding: 0.38em;\r\n  white-space: nowrap;\r\n  background-color: #ccc;\r\n  border-radius: 0.25em;\r\n  cursor: pointer;\r\n}\r\n\r\n.chat-room-module__pointer__36BTp {\r\n  cursor: pointer;\r\n}\r\n\r\n.chat-room-module__chat-controls__1_PZ8 {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.chat-room-module__chat-controls__1_PZ8 * {\r\n  vertical-align: middle;\r\n}\r\n\r\nsvg.chat-room-module__chat-bubble-icon__1He5S {\r\n  width: 0.8em;\r\n  height: 0.8em;\r\n}\r\n\r\nsvg.chat-room-module__gavel-icon__PhVF4 {\r\n  font-size: 1.1em;\r\n}\r\n\r\n.chat-room-module__user-count__2DgMH {\r\n  margin: 0px 5px;\r\n  margin-top: 3px;\r\n}\r\n\r\n.chat-room-module__dialog__1hZxf {\r\n  background: white;\r\n  border: 1px solid rgb(222, 222, 222);\r\n  color: black;\r\n  padding: 13px;\r\n  font-size: 0.85em;\r\n\r\n  position: absolute;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  left: 0;\r\n  right: 0;\r\n  width: 370px;\r\n  max-width: 100vw;\r\n}\r\n\r\n.chat-room-module__dialog__1hZxf header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 1.3em;\r\n}\r\n\r\n.chat-room-module__dialog__1hZxf header svg {\r\n  font-size: 1rem;\r\n  cursor: pointer;\r\n}\r\n\r\n.chat-room-module__dialog__1hZxf header {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.chat-room-module__dialog__1hZxf ul {\r\n  margin: 5px 0px;\r\n  padding-left: 0px;\r\n}\r\n\r\n.chat-room-module__dialog__1hZxf main ul li {\r\n  padding: 3px 0px;\r\n}\r\n\r\n.chat-room-module__premium-dialog__PrNPv label {\r\n  display: block;\r\n}\r\n\r\n.chat-room-module__error-dialog__1180G .chat-room-module__error__8krZC {\r\n  font-size: 1em;\r\n}\r\n\r\n.chat-room-module__profile-editor__1Z9KC svg {\r\n  vertical-align: middle;\r\n}\r\n\r\n.chat-room-module__unread-conversation__2JlgE {\r\n  font-weight: bold;\r\n}\r\n\r\n.chat-room-module__moderators__1EnWr main > div {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.chat-room-module__mod-action-log__2kCk- main > div {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 5px;\r\n}\r\n\r\n.chat-room-module__message-style-editor__3FBel label {\r\n  display: inline-block;\r\n  margin-top: 5px;\r\n}\r\n\r\n.chat-room-module__message-style-editor__3FBel > label {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.chat-room-module__message-style-editor__3FBel label > * {\r\n  width: 100%;\r\n  max-width: 50%;\r\n}\r\n\r\n.chat-room-module__profile-editor__1Z9KC img,\r\n.chat-room-module__profile-editor__1Z9KC svg {\r\n  cursor: pointer;\r\n}\r\n\r\n::-webkit-scrollbar {\r\n  width: 14px;\r\n}\r\n\r\n::-webkit-scrollbar-track {\r\n  background: rgb(226, 226, 226);\r\n}\r\n\r\n::-webkit-scrollbar-thumb {\r\n  background: rgb(255, 121, 0);\r\n}\r\n\r\n.chat-room-module__chat-room-overlay__23Ke6 {\r\n  display: flex;\r\n  position: absolute;\r\n  align-items: center;\r\n  justify-content: center;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, 0.5);\r\n}\r\n\r\n.chat-room-module__overlay-message__1VbBe {\r\n  background: rgb(240, 240, 240);\r\n  color: rgb(24, 23, 23);\r\n  padding: 10px;\r\n  border-radius: 3px;\r\n  text-align: center;\r\n}\r\n\r\n.chat-room-module__message-form__1HwR3 {\r\n  display: flex;\r\n  min-height: 100px;\r\n  font-size: 1.5rem;\r\n  align-items: center;\r\n  width: 100%;\r\n  z-index: 0;\r\n}\r\n\r\n.chat-room-module__message-form__1HwR3 > * {\r\n  height: 100% !important;\r\n}\r\n\r\n.chat-room-module__message-form__1HwR3 > * {\r\n  display: flex;\r\n  align-items: center;\r\n  /* To fix the weird extra space around svgs */\r\n  line-height: 10px;\r\n}\r\n\r\n.chat-room-module__message-form__1HwR3 button {\r\n  width: 20%;\r\n  background-color: rgb(56, 56, 143);\r\n}\r\n\r\n.chat-room-module__message-form__1HwR3 svg {\r\n  /* NOTE: Placeholder */\r\n  border: 1px solid black;\r\n  background: black;\r\n}\r\n\r\n.chat-room-module__camera-icon__3WCDO {\r\n  margin-right: 2px;\r\n}\r\n\r\n.chat-room-module__format-controls__10y60 {\r\n  font-size: 0.8em;\r\n  display: flex;\r\n  height: 1.5em;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  margin-bottom: 0.3em;\r\n}\r\n\r\n.chat-room-module__format-controls__10y60 svg {\r\n  font-size: 1.2em;\r\n}\r\n\r\n.chat-room-module__format-controls__10y60 > *:not(.chat-room-module__menu__jFVYv) {\r\n  cursor: pointer;\r\n  padding-left: 5px;\r\n  padding-right: 5px;\r\n  text-align: center;\r\n  display: flex;\r\n  position: relative;\r\n}\r\n\r\n.chat-room-module__format-controls__10y60 * {\r\n  vertical-align: middle;\r\n}\r\n\r\n.chat-room-module__format-controls__10y60 .chat-room-module__down-arrow__1xxcb {\r\n  margin-left: -1px;\r\n  margin-right: -7px;\r\n}\r\n\r\n.chat-room-module__format-controls__10y60 > em {\r\n  font-family: "Times New Roman", Times, serif;\r\n  font-size: 0.9em;\r\n}\r\n\r\n.chat-room-module__font-color__1wNnY > :nth-child(2) {\r\n  color: rgb(255, 121, 0);\r\n}\r\n\r\n.chat-room-module__font-color__1wNnY > :nth-child(1) {\r\n  fill-opacity: 1;\r\n}\r\n\r\n.chat-room-module__input-wrapper__3XAOG {\r\n  position: relative;\r\n  width: 100%;\r\n}\r\n\r\ntextarea {\r\n  width: 100%;\r\n  height: 100%;\r\n  font-size: 1rem;\r\n  background: none;\r\n  outline: none;\r\n  border: none;\r\n  padding: 10px 15px;\r\n  font-family: sans-serif;\r\n  resize: none;\r\n  background-size: 30% auto;\r\n  position: relative;\r\n  z-index: 1;\r\n}\r\n\r\nbutton {\r\n  /* background-color: #282c34;\r\n  border: none;\r\n  color: white;\r\n  padding: 15px 32px;\r\n  text-align: center;\r\n  text-decoration: none;\r\n  display: inline-block;\r\n  cursor: pointer;\r\n  font-size: 1.25rem; */\r\n\r\n  display: inline-block;\r\n  text-align: center;\r\n  padding: 0.38em;\r\n  white-space: nowrap;\r\n  background-color: #ccc;\r\n  border-radius: 0.25em;\r\n  cursor: pointer;\r\n  border: 0;\r\n}\r\n\r\nbutton:disabled {\r\n  opacity: 0.5;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.chat-room-module__login-form__17kbb button {\r\n  color: #282c34;\r\n}\r\n\r\n.chat-room-module__login-form__17kbb,\r\n.chat-room-module__login-form__17kbb fieldset {\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  width: 100%;\r\n  max-width: 300px;\r\n  text-align: center;\r\n  border: 0;\r\n}\r\n\r\n.chat-room-module__login-form__17kbb fieldset > * {\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.chat-room-module__login-form__17kbb input {\r\n  width: 100%;\r\n}\r\n\r\nul,\r\nli {\r\n  text-align: left;\r\n  list-style: none;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: flex-start;\r\n  background: white;\r\n  border-top: 1px solid;\r\n  font-size: 0.9rem;\r\n  padding: 0 5px;\r\n  background-size: 30% auto;\r\n  z-index: 0;\r\n}\r\n\r\n/* NOTE: Specifity required */\r\n.chat-room-module__chat-app__3_MzT .chat-room-module__message-background-image__1GVy8 {\r\n  position: absolute;\r\n  background-size: 30% auto;\r\n  width: 100%;\r\n  height: 100%;\r\n  left: 0px;\r\n  margin: 0px;\r\n  padding: 0px;\r\n  z-index: -1;\r\n}\r\n\r\n.chat-room-module__input-wrapper__3XAOG .chat-room-module__message-background-image__1GVy8 {\r\n  z-index: 1;\r\n}\r\n\r\n.chat-room-module__sample-message-wrapper__1rBs7 .chat-room-module__message__ii4g0 {\r\n  border-bottom: 1px solid;\r\n}\r\n\r\n.chat-room-module__sample-message-wrapper__1rBs7 {\r\n  background: black;\r\n}\r\n\r\n.chat-room-module__message-username__2rEAl {\r\n  font-family: Arial, Helvetica, sans-serif;\r\n  font-weight: bold;\r\n  vertical-align: middle;\r\n  font-size: 12pt;\r\n}\r\n\r\n.chat-room-module__message-contents__3fJDp {\r\n  margin-left: 5px;\r\n  padding-top: 15px;\r\n  padding-bottom: 5px;\r\n  width: 100%;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 > div {\r\n  margin-left: 5px;\r\n  display: flex;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 p {\r\n  /* white-space: pre-wrap; */\r\n  word-break: break-word;\r\n  margin: 0px;\r\n  display: inline;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 img {\r\n  max-width: 100%;\r\n  max-height: 120px;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 .chat-room-module__mention-highlight__2-BtJ {\r\n  position: absolute;\r\n  left: 0px;\r\n  width: 0px;\r\n  margin: 0px;\r\n}\r\n\r\n.chat-room-module__message__ii4g0.chat-room-module__mention__2SEs0 .chat-room-module__mention-highlight__2-BtJ {\r\n  border-left: 5px solid rgb(255, 204, 0);\r\n}\r\n\r\n.chat-room-module__message-details__3BW5u {\r\n  position: absolute;\r\n  display: flex;\r\n  align-items: flex-end;\r\n  top: 0px;\r\n  right: 0px;\r\n  font-size: 0.75rem;\r\n  padding: 5px;\r\n}\r\n.chat-room-module__message-details__3BW5u svg {\r\n  width: 75%;\r\n  height: 75%;\r\n}\r\n\r\n.chat-room-module__message-timestamp__3U4xB {\r\n  /* width: 100%; */\r\n}\r\n\r\n.chat-room-module__message-details__3BW5u > * {\r\n  vertical-align: middle;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 button {\r\n  width: 15px;\r\n  height: 15px;\r\n  padding: 0;\r\n  font-size: 10px;\r\n  background: none;\r\n  color: black;\r\n  display: inline-flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n\r\n.chat-room-module__message__ii4g0 button:hover {\r\n  background: red;\r\n  color: white;\r\n}\r\n\r\n.chat-room-module__sent__1RTR- {\r\n  /* flex-direction: row-reverse; */\r\n}\r\n\r\n.chat-room-module__sent__1RTR- p {\r\n  /* align-self: flex-end; */\r\n}\r\n\r\n.chat-room-module__received__3BNcl p {\r\n}\r\n\r\n/* NOTE: Specificity required for priority */\r\n.chat-room-module__chat-app__3_MzT .chat-room-module__avatar__1NN6D {\r\n  height: 40px;\r\n  width: 40px;\r\n  margin-top: 5px;\r\n  margin-bottom: 5px;\r\n  border: 1px solid gray;\r\n  vertical-align: middle;\r\n}\r\n',""]),exports.locals={"chat-app":"chat-room-module__chat-app__3_MzT",link:"chat-room-module__link__1wdhd",outlined:"chat-room-module__outlined__2kjUk",bold:"chat-room-module__bold__3OfSp",hidden:"chat-room-module__hidden__1Eq30","loading-placeholder":"chat-room-module__loading-placeholder__3LcAq",loading:"chat-room-module__loading__1jROU",disabled:"chat-room-module__disabled__11rg9",disable:"chat-room-module__disable__1gwvA",rotation:"chat-room-module__rotation__2o1_l",tooltip:"chat-room-module__tooltip__3bTWB","info-tooltip":"chat-room-module__info-tooltip__1Yvsi",yellow:"chat-room-module__yellow__2g5Cj",badge:"chat-room-module__badge__3pH8P",slider:"chat-room-module__slider__1-3ub",error:"chat-room-module__error__8krZC","chat-section":"chat-room-module__chat-section__4_xYW","messages-section":"chat-room-module__messages-section__3Qu29","pagination-controls":"chat-room-module__pagination-controls__1eIje",menu:"chat-room-module__menu__jFVYv",button:"chat-room-module__button__ckGwu",pointer:"chat-room-module__pointer__36BTp","chat-controls":"chat-room-module__chat-controls__1_PZ8","chat-bubble-icon":"chat-room-module__chat-bubble-icon__1He5S","gavel-icon":"chat-room-module__gavel-icon__PhVF4","user-count":"chat-room-module__user-count__2DgMH",dialog:"chat-room-module__dialog__1hZxf","premium-dialog":"chat-room-module__premium-dialog__PrNPv","error-dialog":"chat-room-module__error-dialog__1180G","profile-editor":"chat-room-module__profile-editor__1Z9KC","unread-conversation":"chat-room-module__unread-conversation__2JlgE",moderators:"chat-room-module__moderators__1EnWr","mod-action-log":"chat-room-module__mod-action-log__2kCk-","message-style-editor":"chat-room-module__message-style-editor__3FBel","chat-room-overlay":"chat-room-module__chat-room-overlay__23Ke6","overlay-message":"chat-room-module__overlay-message__1VbBe","message-form":"chat-room-module__message-form__1HwR3","camera-icon":"chat-room-module__camera-icon__3WCDO","format-controls":"chat-room-module__format-controls__10y60","down-arrow":"chat-room-module__down-arrow__1xxcb","font-color":"chat-room-module__font-color__1wNnY","input-wrapper":"chat-room-module__input-wrapper__3XAOG","login-form":"chat-room-module__login-form__17kbb",message:"chat-room-module__message__ii4g0","message-background-image":"chat-room-module__message-background-image__1GVy8","sample-message-wrapper":"chat-room-module__sample-message-wrapper__1rBs7","message-username":"chat-room-module__message-username__2rEAl","message-contents":"chat-room-module__message-contents__3fJDp","mention-highlight":"chat-room-module__mention-highlight__2-BtJ",mention:"chat-room-module__mention__2SEs0","message-details":"chat-room-module__message-details__3BW5u","message-timestamp":"chat-room-module__message-timestamp__3U4xB",sent:"chat-room-module__sent__1RTR-",received:"chat-room-module__received__3BNcl",avatar:"chat-room-module__avatar__1NN6D"},module.exports=exports},962:function(module,exports,__webpack_require__){(exports=__webpack_require__(249)(!1)).push([module.i,".pagination-controls-module__pagination-controls__1X95H {\r\n  display: block;\r\n}\r\n\r\n.pagination-controls-module__pagination-controls__1X95H ul {\r\n  display: flex;\r\n  justify-content: center;\r\n  padding: 0;\r\n}\r\n\r\n.pagination-controls-module__selected__18t-8 a {\r\n  font-weight: bold;\r\n  text-decoration: none;\r\n}\r\n\r\n.pagination-controls-module__disabled__NpDSK a {\r\n  color: #ccc;\r\n  cursor: default;\r\n  text-decoration: none;\r\n}\r\n",""]),exports.locals={"pagination-controls":"pagination-controls-module__pagination-controls__1X95H",selected:"pagination-controls-module__selected__18t-8",disabled:"pagination-controls-module__disabled__NpDSK"},module.exports=exports},973:function(module,exports,__webpack_require__){(exports=__webpack_require__(249)(!1)).push([module.i,".emoji-selector-module__emoji-selector__2etTC section {\n  display: flex;\n  flex-wrap: wrap;\n  max-height: 150px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  justify-content: space-around;\n}\n\n.emoji-selector-module__emoji-selector__2etTC section > * {\n  cursor: pointer;\n  padding: 5px;\n  font-size: 1.3em;\n}\n\n.emoji-selector-module__emoji-selector__2etTC input {\n  width: 100%;\n  padding: 5px;\n  cursor: initial;\n  font-size: initial;\n}\n\n.emoji-selector-module__emoji-selector__2etTC section.emoji-selector-module__preview__24ky7 {\n  color: grey;\n  filter: grayscale(100%);\n}\n\n.emoji-selector-module__emoji-selector__2etTC footer {\n  text-align: center;\n}",""]),exports.locals={"emoji-selector":"emoji-selector-module__emoji-selector__2etTC",preview:"emoji-selector-module__preview__24ky7"},module.exports=exports}},[[600,2,3]]]);